<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0 Strict//EN">
<html>
  <head>
    <title>EPG: Capability IDL</title>
  </head>

  <BODY BGCOLOR="#ffeedd" text="#000000" link="#0000ee" vlink="#551a8b" alink="#ff0000">
    <div class=nocss>
      <br class=nocss>&nbsp;
      <br class=nocss>&nbsp;
    </div>
    <table>
      <tr>
	<td width="10%" valign=top class=toc>
	  <b>UP</b>
	  <br>&nbsp;
	  <br><a href="../../eros.html"><em>EROS Web</em></a> 
	  <br>&nbsp;
	  <br><a href="../00Devel.html"><em>Developer Documentation</em></a> 
	  <br>&nbsp;
	  <br><a href="Cover.html"><em>Programmer's Guide</em></a> 
	</td>
	<td width="5%">&nbsp;</td>
	<td valign=top>
	  <center>
	    <h1 class=title>Capability IDL</h1>
	    <em>D R A F T</em>
	    <div class=nocss>
	      <br class=nocss>&nbsp;
	      <br class=nocss>&nbsp;
	    </div>
	  </center>
	  <p>
	    <IMG src="../../img/construction.gif" align=left>
	      <em>Please note that the CapIDL implementation is still a
		work in progress. As such, this document is a ``best
		effort'' to provide documentation of CapIDL, but it may
		be dated or incomplete.</em>
	  </p>
	  <p>
	    <b>CapIDL</b> is the interface definition language used to
	    describe objects in the EROS system. Most programs in EROS
	    export one or more object types. Each of these types of
	    object has an associated capability type. CapIDL provides
	    a uniform way of describing the methods, attributes, and
	    behavior of these objects.
	  </p>
	  <p>
	    CapIDL is derived from version 2.4.1 of the OMG/CORBA IDL.
	    Developers who are already familiar with OMG/CORBA IDL
	    specifications may find that the section <a
	    href="#corba_diff">How CapIDL differs from CORBA IDL</a>
	    provides enough information to get productivelystarted.
	  </p>
	  <h1><a name="capidl">An IDL for Capabilities</a></h1>
	  <p>
	    CapIDL is an Interface Description Language (IDL) for
	    describing capability systems. It is similar to the CORBA
	    IDL -- potentially similar enough to cause confusion for
	    programmers who are already familiar with CORBA. The
	    section <a href="#corba_diff">How CapIDL Differs from
	    CORBA</a> describes the syntactic differences between
	    CapIDL and CORBA IDL. This section provides conceptual
	    background. Readers familiar with the CORBA or ONC IDLs
	    are strongly encouraged to read it, because CapIDL differs
	    in some subtle ways from both of these.
	  </p>
	  <p>
	    The usual purpose of an IDL is to specify interfaces
	    between components subsystems in a language-neutral
	    way. Typically, IDLs make no assumptions about how these
	    components are ...
	  </p>
	  <h1><a name="corba_diff">How CapIDL differs from CORBA IDL</a></h1>
	  <p>
	    CapIDL is derived from the OMG/CORBA IDL version 2.4.1,
	    but it has been specialized in various ways to meet the
	    needs of capability systems.  This section briefly
	    summarizes the differences. We first describe the one
	    major conceptual differences, and then identify various
	    minor changes.
	  </p>
	  <h2>Interfaces are Types</h2>
	  <p>
	    The biggest difference is that in CapIDL the notion of an
	    "interface" has been unified with the notion of a
	    capability. In conventional IDLs, an interface is merely a
	    set of entry points that are published by a service
	    program. In capability systems, service programs can
	    export several different interfaces as different
	    capabilities, and each of these interfaces is associated
	    with a particular capability type. Another way to say this
	    is that interface boundaries in capability systems are
	    strongly enforced.
	  </p>
	  <p>
	    There are two corollaries to this:
	  </p>
	  <ul>
	    <li>
	      <p>
		Because there is no common supertype between
		capabilities and data, CapIDL does not include an
		<b>ANY</b> keyword. The <b>Object</b> type remains,
		and means ``any interface type.'' That is: ``any
		capability type''
	      </p>
	    </li>
	    <li>
	      <p>
		An interface identifier is now a type
		name. Specifically, it is the type name for the
		capability type corresponding to that interface.
	      </p>
	    </li>
	  </ul>
	  <h2>Constant Arithmetic</h2>
	  <p>
	    In CapIDL, all constant computations are performed using
	    arbitrary precision two's complement integer
	    arithmetic. The results are then truncated apropriately
	    for the destination type.
	  </p>
	  <p>
	    In practice, this has very little impact. It can, however,
	    lead to surprises in a few specific circumstances:
	  </p>
	  <ul>
	    <li>
	      <p>
		Arithmetic operations between signed and unsigned
		types are always performed using signed arithmetic.
	      </p>
	    </li>
	    <li>
	      <p>
		Casts to unsigned depending on bit representation
		don't work. In particular, the preferred way to
		specify the most negative value of an integer type' is
		to use the new <b>min</b> and <b>max</b> operators:
	      </p>
	      <ul>
		<pre>
min(long)            /* minimum signed 32-bit quantity */
max(unsigned short)  /* max unsigned 16-bit quantity */
min(integer<8>)      /* minimum signed 8-bit quantity */
		</pre>
	      </ul>
	    </li>
	  </ul>
	  <h2>Omissions</h2>
	  <p>
	    The following features of CORBA IDL are missing in CapIDL:
	  </p>
	  <ul>
	    <li>
	      <p>
		There is no support for specifying
		inheritance. (Possible future)
	      </p>
	    </li>
	    <li>
	      <p>
		Valuetypes are absent. (Possible future)
	      </p>
	    </li>
	    <li>
	      <p>
		There is no support for fixed-point constants or
		types. (Possible future)
	      </p>
	    </li>
	    <li>
	      <p>
		Constant arithmetic is currently
		unimplemented. (Implementation expedience; this is a
		bug).
	      </p>
	    </li>
	    <li>
	      <p>
		The notions of abstract and local interfaces is
		removed.
	      </p>
	    </li>
	    <li>
	      <p>
		CapIDL has no <b>inout</b> parameters. The <b>in</b>
		parameter keyword is optional.
	      </p>
	    </li>
	    <li>
	      <p>
		The entire notion of ``context'' is incompatible with
		capabilities (and for that matter with any enforceable
		sort of security), and is gone. (No, we will not add
		this. Not ever. Really!)
	      </p>
	    </li>
	  </ul>
	  <h2>Additions/Changes</h2>
	  <p>
	    The following changes and additions have been made to the
	    OMG/CORBA IDL language:
	  </p>
	  <ul>
	    <li>
	      <p>
		In CapIDL, a discriminated union must specify an
		identifier corresponding to the discriminator value.
	      </p>
	    </li>
	    <li>
	      <p>
		The CapIDL <b>oneway</b> message allows one parameter
		to be specified as the <b>resume</b> parameter.

		has no <b>inout</b> parameters. The <b>in</b>
		parameter keyword is optional.
	      </p>
	    </li>
	  </ul>
	  <hr>
	  <em>Copyright 2001 Jonathan Shapiro.  All rights
	  reserved.  For terms of redistribution, see the <a
	  href="../../legal/license/GPL.html">EROS License
	  Agreement</a></em>
	</td>
	<td valign=top width="15%">&nbsp;</td>
      </tr>
    </table>
  </body>
</html>

