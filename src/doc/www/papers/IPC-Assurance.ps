%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: IPC-Assurance.dvi
%%Pages: 12
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Italic Times-Bold Courier
%%+ Times-BoldItalic Helvetica-Bold
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -t letter -o tmp.ps IPC-Assurance.dvi
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2003.05.27:0839
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
TeXDict begin 40258431 52099146 1000 600 600 (IPC-Assurance.dvi)
@start
%DVIPSBitmapFont: Fa cmmi9 9 1
/Fa 1 23 df<1307D90FC01338011F147C16FC5CA2013F1301A202005BA2491303A2017E
5CA201FE1307A2495CA20001140FA2495C17800003021F13C016C149EC8180A20007EC3F
836D017F130016034B5A3A0FFC03CF869039FE070F8E9039DFFE07FC9039C3F801F0D81F
C0C9FCA25BA2123FA290CAFCA25AA2127EA212FEA25A12382A327FA02E>22
D E
%EndDVIPSBitmapFont
/Fb 107[42 42 24[29 33 33 50 33 37 21 29 29 1[37 37 37
54 21 33 21 21 37 37 21 33 37 33 37 37 7[42 46 62 46
54 42 37 46 1[46 54 50 62 3[25 54 54 46 46 54 50 46 46
6[25 37 37 37 37 37 37 37 37 37 37 21 19 25 5[25 39[{
TeXBase1Encoding ReEncodeFont}63 74.7198 /Times-Italic
rf /Fc 87[25 17[37 27[33 37 37 54 37 37 21 29 25 1[37
37 37 58 21 37 21 21 37 37 25 33 37 33 37 33 3[25 1[25
46 54 54 71 54 54 46 42 50 54 42 54 54 66 46 54 29 25
54 54 42 46 54 50 50 54 6[21 37 37 37 37 37 37 37 37
37 37 21 19 25 19 2[25 25 36[42 42 2[{TeXBase1Encoding ReEncodeFont}74
74.7198 /Times-Roman rf
%DVIPSBitmapFont: Fd cmr7 7 2
/Fd 2 50 df<EB3F803801FFF03803E0F83807803C48487E001E7F003E1480A2003C1307
007C14C0A400FC14E0AE007C14C0A36CEB0F80A36CEB1F006C131E6C6C5A3803E0F86CB4
5A38003F801B277EA521>48 D<13381378EA01F8121F12FE12E01200B3AB487EB512F8A2
15267BA521>I E
%EndDVIPSBitmapFont
/Fe 134[50 2[50 50 50 50 50 2[50 50 1[50 2[50 50 50 50
50 50 50 1[50 13[50 9[50 1[50 50 7[50 1[50 50 14[50 1[50
50 50 40[{TeXBase1Encoding ReEncodeFont}28 83.022 /Courier
rf /Ff 82[28 51[46 2[46 51 28 46 32 1[51 51 51 74 23
2[23 2[28 46 51 46 51 46 12[51 55 2[55 6[23 5[60 17[46
2[23 46[{TeXBase1Encoding ReEncodeFont}26 83.022 /Helvetica-Bold
rf
%DVIPSBitmapFont: Fg cmmi10 10 5
/Fg 5 84 df<1760177017F01601A21603A21607160FA24C7EA216331673166316C3A2ED
0183A2ED0303150683150C160115181530A21560A215C014011580DA03007FA202061300
140E140C5C021FB5FC5CA20260C7FC5C83495A8349C8FC1306A25BA25B13385B01F01680
487E000716FFB56C013F13FF5EA2383C7DBB3E>65 D<0103B77E4916F018FC903B0007F8
0003FE4BEB00FFF07F80020FED3FC0181F4B15E0A2141FA25DA2143F19C04B143F198002
7F157F190092C812FE4D5A4A4A5AEF0FF04AEC1FC005FFC7FC49B612FC5F02FCC7B4FCEF
3FC00103ED0FE0717E5C717E1307844A1401A2130F17035CA2131F4D5A5C4D5A133F4D5A
4A4A5A4D5A017F4BC7FC4C5A91C7EA07FC49EC3FF0B812C094C8FC16F83B397DB83F>I<
902603FFF891381FFFF8496D5CA2D90007030113006FEC007C02061678DA0EFF15708102
0C6D1460A2DA1C3F15E0705CEC181F82023815016F6C5C1430150702706D1303030392C7
FC02607FA2DAE0015C701306ECC0008201016E130EEF800C5C163F0103EDC01C041F1318
91C713E0160F49EDF03818300106140717F8010E02031370EFFC60130CEE01FE011C16E0
04005B011815FF177F1338600130153FA20170151F95C8FC01F081EA07FCB512E01706A2
45397DB843>78 D<0103B7FC4916E018F8903B0007F80007FC4BEB00FE187F020FED3F80
F01FC05DA2021F16E0A25DA2143FF03FC05DA2027FED7F80A292C8130018FE4A4A5A604A
EC07F04D5A0101ED3FC04CB4C7FC91B612FC17E0D903FCCAFCA25CA21307A25CA2130FA2
5CA2131FA25CA2133FA25CA2137FA291CBFC497EB6FCA33B397DB835>80
D<92391FE00380DBFFFC130002036D5A91390FE01F8F91393F0007DF027EEB01FE02F813
00495A4948147E177C4948143C495AA2011F153891C8FCA3491530A28094C7FC80806D7E
14FEECFFE06D13FE6DEBFFC06D14F06D806D80021F7F02037FEC003F03037F1500167F16
3F161FA3120C160FA2001C151F94C7FCA3003C153EA25E003E5D127E007F4A5A6D495A6D
EB0FC0D8F9F0495AD8F0FE01FEC8FC39E03FFFF8010F13E0D8C00190C9FC313D7CBA33>
83 D E
%EndDVIPSBitmapFont
/Fh 134[42 2[42 46 28 32 37 1[46 42 46 69 23 46 1[23
46 42 28 37 46 37 46 42 9[83 60 1[55 46 60 1[51 65 1[78
55 2[32 2[51 55 60 1[55 60 12[42 42 42 42 2[21 1[21 44[{
TeXBase1Encoding ReEncodeFont}42 83.022 /Times-Bold rf
%DVIPSBitmapFont: Fi cmsy10 10 1
/Fi 1 16 df<EB1FF0EBFFFE487F000714C04814E04814F04814F8A24814FCA3B612FEA9
6C14FCA36C14F8A26C14F06C14E06C14C0000114006C5BEB1FF01F1F7BA42A>15
D E
%EndDVIPSBitmapFont
/Fj 204[25 25 25 49[{TeXBase1Encoding ReEncodeFont}3
49.8132 /Times-Roman rf /Fk 204[29 29 29 49[{
TeXBase1Encoding ReEncodeFont}3 58.1154 /Times-Roman
rf /Fl 105[42 1[37 37 24[37 42 42 60 42 42 23 32 28 42
42 42 42 65 23 42 23 23 42 42 28 37 42 37 42 37 3[28
1[28 1[60 60 78 60 60 51 46 55 1[46 60 60 74 51 60 32
28 60 60 46 51 60 55 55 60 5[23 23 42 42 42 42 42 42
42 42 42 42 23 21 28 21 2[28 28 28 1[69 33[46 46 2[{
TeXBase1Encoding ReEncodeFont}77 83.022 /Times-Roman
rf /Fm 134[37 1[55 37 46 23 32 32 1[42 42 46 65 23 1[23
23 46 42 28 37 42 37 42 42 13[46 55 6[55 1[32 7[55 6[28
12[28 45[{TeXBase1Encoding ReEncodeFont}29 83.022 /Times-BoldItalic
rf /Fn 134[37 37 55 37 42 23 32 32 42 42 42 42 60 23
37 23 23 42 42 23 37 42 37 42 42 9[69 2[46 42 51 1[51
60 1[69 46 2[28 2[51 51 1[55 51 7[28 5[42 5[21 28 21
2[28 28 36[42 42 2[{TeXBase1Encoding ReEncodeFont}47
83.022 /Times-Italic rf /Fo 134[50 50 2[55 33 39 44 1[55
50 55 83 28 2[28 55 50 33 44 55 44 55 50 10[72 1[66 55
72 1[61 78 1[94 66 2[39 3[66 72 72 66 72 11[50 50 50
50 50 2[25 43[55 2[{TeXBase1Encoding ReEncodeFont}41
99.6264 /Times-Bold rf /Fp 140[60 60 1[60 60 6[60 60
1[60 3[60 32[60 17[60 60 45[{TeXBase1Encoding ReEncodeFont}11
99.6264 /Courier rf /Fq 134[50 2[50 50 28 39 33 1[50
50 50 78 1[50 1[28 50 1[33 44 1[44 1[44 11[72 1[55 8[39
1[72 3[72 66 20[25 46[{TeXBase1Encoding ReEncodeFont}24
99.6264 /Times-Roman rf /Fr 134[60 1[86 60 66 40 47 53
1[66 60 66 100 33 66 1[33 66 60 40 53 66 53 66 60 9[120
86 1[80 66 86 1[73 93 2[80 2[47 3[80 86 86 80 86 8[60
60 60 60 60 60 60 60 49[{TeXBase1Encoding ReEncodeFont}44
119.552 /Times-Bold rf /Fs 134[29 2[29 33 18 26 26 1[33
33 33 48 3[18 3[29 33 29 1[33 13[33 2[41 6[22 3[41 17[33
33 1[33 48[{TeXBase1Encoding ReEncodeFont}22 66.4176
/Times-Italic rf /Ft 133[29 33 1[48 33 33 18 26 22 33
33 33 33 52 18 33 18 18 33 33 22 29 33 29 33 29 7[48
1[63 1[48 41 37 44 1[37 48 48 1[41 2[22 3[41 48 44 1[48
5[18 3[33 33 1[33 33 33 1[33 1[17 22 17 40[37 3[{
TeXBase1Encoding ReEncodeFont}51 66.4176 /Times-Roman
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: Letter
letter
%%EndPaperSize

%%EndSetup
%%Page: 1 1
1 0 bop 2210 -252 a Ft(Appears)18 b(in)g(the)f Fs(2003)h(IEEE)d
(Symposium)j(on)f(Security)j(and)d(Privacy)p Ft(,)3400
-152 y(Oakland,)h(CA)f(2003)837 383 y Fr(V)-11 b(ulnerabilities)32
b(in)f(Synchr)n(onous)g(IPC)f(Designs)1553 698 y Fq(Jonathan)24
b(S.)h(Shapiro)1282 814 y(Department)f(of)h(Computer)f(Science)1434
931 y(Johns)g(Hopkins)g(Uni)n(v)o(ersity)1472 1047 y
Fp(shap@eros-os.org)769 1514 y Fo(Abstract)100 1713 y
Fn(Recent)19 b(advances)f(in)i(interpr)l(ocess)g(communication)d
(\(IPC\))0 1812 y(performance)47 b(have)g(been)g(e)n(xclusively)h
(based)f(on)g(thr)m(ead-)0 1912 y(migr)o(ating)16 b(IPC)h(designs.)23
b(Thr)m(ead-migr)o(ating)15 b(designs)h(assume)0 2012
y(that)i(IPC)g(inter)o(actions)e(ar)m(e)i(sync)o(hr)l(onous,)f(and)g
(that)g(user)n(-le)o(vel)0 2111 y(e)n(xecution)33 b(will)i(usually)f(r)
m(esume)g(with)h(the)f(in)m(vok)o(ed)f(pr)l(ocess)0 2211
y(\(modulo)c(pr)m(eemption\).)55 b(This)32 b(IPC)f(design)f(appr)l(oac)
o(h)f(of)o(fer)o(s)0 2311 y(shorter)20 b(instruction)f(path)g(lengths,)
g(r)m(equir)m(es)h(fe)o(wer)g(loc)n(ks,)g(has)0 2410
y(smaller)37 b(instruction)f(and)f(data)g(cac)o(he)h(footprints,)j(dr)o
(amat-)0 2510 y(ically)c(r)m(educes)h(TLB)g(o)o(verheads,)i(and)c
(consequently)g(of)o(fer)o(s)0 2609 y(higher)23 b(performance)f(and)h
(lower)h(timing)f(variance)g(than)f(pr)m(e-)0 2709 y(vious)i(IPC)h
(designs.)38 b(W)-5 b(ith)25 b(car)m(e)o(,)h(it)f(can)f(be)h(performed)
f(as)g(an)0 2809 y(atomic)c(unit)g(of)g(oper)o(ation.)100
2908 y(While)34 b(the)g(performance)f(of)h(thr)m(ead-migr)o(ating)e
(IPC)i(has)0 3008 y(been)i(e)n(xamined)f(in)i(detail,)i(the)e(vulner)o
(abilities)e(implicit)i(in)0 3108 y(sync)o(hr)l(onous)42
b(IPC)i(designs)f(have)h(not)f(been)g(e)n(xamined)g(in)0
3207 y(depth)19 b(in)i(the)f(ar)m(c)o(hival)g(liter)o(atur)m(e)o(,)g
(and)f(their)i(implications)f(for)0 3307 y(IPC)26 b(design)g(have)f
(been)g(actively)h(misunder)o(stood)e(in)j(at)f(least)0
3406 y(one)35 b(r)m(ecent)g(publication.)68 b(In)34 b(addition)g(to)h
(performance)o(,)j(a)0 3506 y(sound)27 b(IPC)h(design)g(must)g(addr)m
(ess)g(concerns)g(of)g(asymmetric)0 3606 y(trust)20 b(and)d(r)m(epr)l
(oducibility)h(and)g(pr)l(o)o(vide)g(support)g(for)h(dynamic)0
3705 y(payload)26 b(lengths.)49 b(Pr)m(e)o(vious)28 b(IPC)h(designs,)h
(including)c(those)0 3805 y(of)19 b(ER)m(OS,)e(Mac)o(h,)h(L4,)h(Flask,)
g(and)f(P)-7 b(ebble)o(,)18 b(satisfy)i(only)e(two)h(of)0
3905 y(these)h(thr)m(ee)h(r)m(equir)m(ements.)100 4004
y(In)26 b(this)i(paper)-9 b(,)28 b(we)g(show)f(how)g(these)g(thr)m(ee)h
(design)e(objec-)0 4104 y(tives)h(can)e(be)i(met)f(simultaneously)-5
b(.)42 b(W)-8 b(e)27 b(identify)f(the)g(con\003ict)0
4203 y(of)j(r)m(equir)m(ements)g(and)g(illustr)o(ate)g(how)h(their)f
(collision)g(arises)0 4303 y(in)18 b(two)f(well-documented)f(IPC)h(ar)m
(c)o(hitectur)m(es:)23 b(L4)18 b(and)e(ER)m(OS.)0 4403
y(W)-8 b(e)20 b(then)e(show)h(how)g(all)g(thr)m(ee)g(design)f
(objectives)g(ar)m(e)h(simulta-)0 4502 y(neously)g(met)i(in)f(the)h(ne)
n(xt)f(g)o(ener)o(ation)e(ER)m(OS)i(IPC)g(system.)0 4643
y Fm(K)n(eyw)o(ords:)43 b Fn(oper)o(ating)27 b(systems,)33
b(capability)27 b(systems,)33 b(inter)n(-)0 4743 y(pr)l(ocess)21
b(communication,)c(vulner)o(ability)-5 b(.)0 5083 y Fr(1)119
b(Intr)n(oduction)0 5209 y Fl(Thread-migrating)24 b(interprocess)j
(communication)e(\(IPC\))j(de-)0 5309 y(signs)38 b(are)f(one)g(of)g
(the)h(dri)n(ving)e(forces)h(behind)f(the)h(current)0
5408 y(resur)o(gence)27 b(of)i(interest)g(in)h(microk)o(ernel-based)c
(systems.)52 b(In)1992 1514 y(particular)m(,)22 b(IPC)j
(implementations)c(by)j(Liedtk)o(e)f([20)o(,)h(21)o(],)g(and)1992
1613 y(Shapiro)j([30)n(])i(ha)n(v)o(e)f(sho)n(wn)g(that)g(protected)f
(IPC)i(in)m(v)n(ocations)1992 1713 y(can)38 b(be)g(reduced)f(into)h
(the)h(135)e(c)o(ycle)h(range)g(on)g(Pentium-)1992 1812
y(f)o(amily)33 b(processors.)2615 1782 y Fk(1)2713 1812
y Fl(Experimental)e(analysis)j(by)f(F)o(ord)g([8)o(])1992
1912 y(sho)n(ws)18 b(that)g(much)g(of)g(this)h(performance)c(adv)n
(antage)h(cannot)i(be)1992 2012 y(achie)n(v)o(ed)k(in)j(asynchronous)d
(IPC)j(mechanisms.)38 b(Gi)n(v)o(en)23 b(these)1992 2111
y(results,)33 b(performance-moti)n(v)n(ated)25 b(reports)30
b(of)h(the)f(demise)h(of)1992 2211 y(microk)o(ernels)19
b([3)o(])i(may)g(ha)n(v)o(e)f(been)g(premature.)26 b(The)21
b(question)1992 2311 y(of)e(security-moti)n(v)n(ated)f(demise)i
(remains)f(open.)2091 2413 y(The)d Fn(potential)g Fl(security)g
(bene\002t)g(of)g(high-performance)c(IPC)1992 2513 y(is)23
b(straightforw)o(ard.)31 b(In)22 b(contrast)g(to)h(asynchronous)d(or)j
(b)n(uf)n(fer)n(-)1992 2612 y(ing)28 b(IPC)h(designs)f([1,)h(27)o(],)h
(the)f(latenc)o(y)f(of)g(thread-migrating)1992 2712 y(IPC)45
b(is)i(lo)n(w)e(enough)e(that)j(applications)e(can)h(be)g(f)o(actored)
1992 2812 y(into)31 b(multiple)h(protection)f(domains,)i(each)f
(encapsulated)f(by)1992 2911 y(a)g(process)f(boundary)d(and)j(selecti)n
(v)o(ely)g(link)o(ed)g(by)g(protected,)1992 3011 y(IPC-based)38
b(communication.)78 b(Domain-based)36 b(isolation)j(is)1992
3111 y(an)e(essential)g(b)n(uilding)f(block)h(for)f(high-assurance)f
(systems)1992 3210 y([19)n(,)28 b(33)o(,)f(29)o(,)g(5,)g(12)o(,)g(31)o
(].)46 b(At)28 b(least)f(one)g(commercial)e(system)1992
3310 y(has)j(been)h(constructed)e(using)h(this)h(approach)e(to)i
(domain)e(en-)1992 3409 y(forcement)18 b([11)o(].)2091
3512 y(Selected)30 b(denial)g(of)g(service)g(attacks)g(against)f(the)i
(L4)f(mi-)1992 3612 y(crok)o(ernel)d(and)h(its)i(serv)o(ers)e
(\(including)f(se)n(v)o(eral)h(re-e)o(xamined)1992 3711
y(here\))j(ha)n(v)o(e)h(been)g(brie\003y)g(e)o(xamined)e(in)j(the)f
(literature)g([22)o(].)1992 3811 y(This)24 b(paper)f(pro)o(vides)f(an)i
(in-depth)e(e)o(xposure)h(of)g(application-)1992 3911
y(le)n(v)o(el)i(vulnerabilities)g(that)h(are)g(implicit)g(in)h
Fn(any)e Fl(synchronous)1992 4010 y(IPC)e(system.)32
b(When)23 b(a)g(synchronous)d(communication)g(mech-)1992
4110 y(anism)g(is)h(introduced,)d(the)i(security)g(and)g(trust)g
(implications)g(of)1992 4209 y(sender)15 b(blocking)g(must)i(be)f
(considered.)22 b(When)17 b(the)f(system)h(de-)1992 4309
y(sign)29 b(also)h(incorporates)d(user)n(-le)n(v)o(el)h(pagers)h([1)o
(],)j(interactions)1992 4409 y(between)20 b(these)i(pagers,)f(string)g
(transfers,)h(and)f(blocking)f(must)1992 4508 y(also)29
b(be)h(considered.)51 b(Relati)n(v)o(ely)29 b(e)o(xperienced)e(IPC)k
(design-)1992 4608 y(ers)d(ha)n(v)o(e)f(f)o(ailed)h(to)h(recognize)d
(the)i(potential)f(security)h(issues)1992 4708 y(inherent)18
b(in)j(this)f(combination)e([7)o(].)2091 4810 y(A)23
b(satisf)o(actory)g(IPC)g(design)f(must)h(simultaneously)e(satisfy)1992
4910 y(certain)27 b(functional,)g(testability)-5 b(,)29
b(and)f(security)f(requirements.)1992 5009 y(In)19 b(particular:)p
1992 5093 764 4 v 1992 5148 a Fj(1)2058 5172 y Ft(These)f(results)h
(predate)h(the)f(introduction)i(of)d(the)h(Pentium)g(f)o(amily)g(f)o
(ast)g(sys-)2058 5251 y(tem)k(call)g(instructions.)40
b(Comparably)24 b(careful)h(implementations)g(of)e(those)2058
5329 y(designs)14 b(on)f(current)i(machines)g(should)f(therefore)i
(reduce)e(the)g(common)g(case)2058 5408 y(IPC)j(time)h(do)n(wn)f(into)h
(the)g(60-70)f(c)o(ycle)i(designs.)1929 5657 y Fl(1)p
eop
%%Page: 2 2
2 1 bop 83 91 a Fi(\017)41 b Fh(Asymmetric)27 b(T)-6
b(rust)p Fl(:)39 b(The)27 b(IPC)g(architecture)f(must)g(not)166
191 y(embed)e(an)o(y)h(assumption)f(that)i(the)f(sender)g(trusts)h(the)
f(re-)166 291 y(cipient.)83 560 y Fi(\017)41 b Fh(Repr)o(oducibility)p
Fl(:)23 b(The)16 b(beha)n(vior)g(of)g(the)h(IPC)h(primiti)n(v)o(es)166
660 y(should)24 b(not)g(be)h(in\003uenced)e(by)h(e)o(xogenous)e(f)o
(actors)i(such)166 759 y(as)29 b(system)g(load.)50 b(This)29
b(is)g(required)e(for)h(testability)h(and)166 859 y(operational)f
(predictability)f(under)h(v)n(ariations)h(in)g(w)o(ork-)166
958 y(load.)83 1228 y Fi(\017)41 b Fh(Dynamic)25 b(P)o(ayload)p
Fl(:)33 b(The)24 b(IPC)i(architecture)d(must)i(sup-)166
1327 y(port)31 b(transmission)g(of)g(messages)h(whose)f(length)g(is)h
(not)166 1427 y(kno)n(wn)15 b(in)i(adv)n(ance)e(to)i(the)g(recei)n
(ving)e(party)-5 b(.)23 b(W)m(ithout)16 b(dy-)166 1527
y(namic)31 b(payload)f(support,)j(procedures)c(returning)g(\(e.g.\))166
1626 y(precise)k(\(unbounded\))d(inte)o(gers)j(or)g(dynamically)f
(sized)166 1726 y(v)o(ectors)19 b(cannot)g(be)i(handled)d(at)j(the)f
(IPC)h(interf)o(ace.)100 1969 y(This)27 b(particular)f(set)i(of)e
(requirements)g(is)i(decepti)n(v)o(ely)d(dif-)0 2069
y(\002cult)31 b(to)f(satisfy)h(simultaneously)-5 b(.)54
b(Due)31 b(to)f(the)h(presence)e(of)0 2169 y(timeouts,)35
b(Mach)d(and)f(L4)h(f)o(ail)h(the)f(reproducibility)e(require-)0
2268 y(ment.)24 b(In)19 b(the)g(absence)g(of)g(timeouts)g(or)g
(truncation,)e(Pebble)i([9)o(])0 2368 y(and)g(Fluk)o(e)h([7)o(])h(f)o
(ail)f(the)g(asymmetric)f(trust)h(requirement.)i(Prior)0
2467 y(to)17 b(the)g(w)o(ork)g(reported)e(here,)i(ER)m(OS)g(f)o(ailed)g
(the)g(dynamic)e(string)0 2567 y(requirement.)100 2693
y(This)36 b(paper)f(e)o(xamines)g(in)i(detail)f(certain)g(denial)g(of)g
(ser)n(-)0 2792 y(vice)22 b(problems)e(that)i(arise)g(in)g(synchronous)
e(IPC)i(designs.)30 b(W)-7 b(e)0 2892 y(identify)22 b(the)i(cases)g(in)
f(which)g(there)g(is)h(potential)f(for)f(such)h(de-)0
2991 y(nial,)d(and)g(describe)f(the)h(a)n(v)n(ailable)g(mechanisms)f
(in)h(ER)m(OS)h(and)0 3091 y(L4)30 b(by)g(which)g(applications)g(may)g
(attempt)g(to)g(protect)g(them-)0 3191 y(selv)o(es.)73
b(W)-7 b(e)38 b(sho)n(w)e(ho)n(w)g(the)g(ne)o(xt)f(generation)g(ER)m
(OS)h(IPC)0 3290 y(subsystem)25 b(simultaneously)f(meets)i(all)g(three)
g(of)f(the)h(require-)0 3390 y(ments)18 b(identi\002ed)g(abo)o(v)o(e,)f
(and)h(in)h(the)f(process)g(sho)n(w)h(that)f(func-)0
3490 y(tional)j(requirements)e(such)i(as)g(support)f(for)h(dynamic)e
(message)0 3589 y(payloads)24 b(need)h(not)h(sacri\002ce)f
(reproducibility)-5 b(.)38 b(The)26 b(primary)0 3689
y(goals)18 b(of)h(this)g(paper)f(are)g(to)h(ensure)f(that)h(denial)f
(of)g(service)h(vul-)0 3788 y(nerabilities)f(are)g(not)g(ne)o(glected)e
(in)i(future)f(IPC)i(designs,)f(and)g(to)0 3888 y(sho)n(w)d(ho)n(w)g
(the)o(y)g(are)h(addressed)e(in)i(the)g(ne)o(xt-generation)c(ER)m(OS)0
3988 y(IPC)21 b(system.)100 4113 y(The)h(balance)g(of)g(this)h(paper)e
(proceeds)h(as)h(follo)n(ws.)32 b(In)22 b(sec-)0 4213
y(tion)28 b(2,)i(we)e(selecti)n(v)o(ely)g(re)n(vie)n(w)f(the)h(L4)g
(and)g(ER)m(OS)h(IPC)f(de-)0 4312 y(signs.)c(Section)14
b(3)i(describes)f(the)g(problem)f(of)h(asymmetric)f(trust)0
4412 y(in)32 b(detail)f(and)g(the)g(options)g(for)f(dealing)h(with)g
(this)h(problem.)0 4512 y(Section)25 b(4)h(performs)d(a)j(further)e
(case)i(analysis)g(on)f(IPC)h(safety)0 4611 y(in)21 b(conditions)e(of)i
(asymmetric)f(trust,)h(identifying)e(man)o(y)g(cases)0
4711 y(where)i(e)o(xisting,)g(lo)n(w)h(cost)f(mechanisms)g(are)h(suf)n
(\002cient)f(to)g(ad-)0 4811 y(dress)d(the)g(problem)e(and)h
(introduces)f(the)i Fm(trusted)g(b)n(uf)o(f)o(er)g(object)0
4910 y Fl(\(TBO\),)j(a)h(solution)f(for)g(the)g(general)g(case.)29
b(Section)21 b(5)h(justi\002es)0 5010 y(why)17 b(the)i(TBO)g(can)f(be)g
(trusted)g(where)g(an)g(ordinary)e(client)j(can-)0 5109
y(not,)33 b(and)d(establishes)h(additional)f(requirements)f(on)h(the)h
(IPC)0 5209 y(subsystem)20 b(that)h(are)f(necessary)g(to)h(achie)n(v)o
(e)f(an)g(ef)n(fecti)n(v)o(e)f(TBO)0 5309 y(design.)24
b(The)19 b(remaining)e(sections)i(describe)f(related)h(w)o(ork,)f(ac-)0
5408 y(kno)n(wledgments,)f(and)j(conclusions.)1992 91
y Fr(2)119 b(Re)n(view)41 b(of)e(the)i(L4)e(and)i(ER)l(OS)g(IPC)2171
241 y(Designs)1992 384 y Fl(This)24 b(paper)f(e)o(xplores)g(tw)o(o)i
(interprocess)e(communication)e(de-)1992 484 y(signs)g(for)g(purposes)g
(of)g(illustration)g(and)g(discussion:)27 b(those)22
b(of)1992 583 y(L4)31 b(and)g(ER)m(OS.)h(From)f(a)h(feature)f
(perspecti)n(v)o(e,)h(the)g(tw)o(o)g(de-)1992 683 y(signs)25
b(ha)n(v)o(e)f(been)h(con)m(v)o(er)o(ging)c(for)j(se)n(v)o(eral)h
(years.)39 b(Both)25 b(ha)n(v)o(e)1992 782 y(been)19
b(carefully)f(engineered)g(and)h(speci\002ed,)g(b)n(ut)h(the)o(y)g
(embody)1992 882 y(some)n(what)28 b(dif)n(ferent)h(vie)n(ws)g(of)h(ho)n
(w)f(IPC)i(should)e(be)g(imple-)1992 982 y(mented.)81
b(Before)38 b(proceeding)f(to)i(the)h(body)d(of)i(the)h(paper)1992
1081 y(proper)m(,)15 b(it)i(is)h(useful)e(to)h(brie\003y)f(re)n(vie)n
(w)g(these)h(tw)o(o)g(IPC)g(designs.)1992 1181 y(The)25
b(descriptions)f(pro)o(vided)f(belo)n(w)i(are)g(not)g(comprehensi)n(v)o
(e,)1992 1281 y(focusing)16 b(instead)j(on)e(those)i(portions)e(of)h
(the)g(tw)o(o)h(IPC)g(systems)1992 1380 y(that)h(are)g(rele)n(v)n(ant)f
(to)h(denial)g(of)g(service)g(vulnerabilities.)1992 1631
y Fo(2.1)99 b(L4)25 b(IPC)1992 1785 y Fl(The)31 b(L4)h(IPC)g(system)g
([20)o(,)g(21)o(])g(implements)f(a)i(single)e(basic)1992
1885 y(primiti)n(v)o(e)23 b Fm(SendAndReceiv)o(e)p Fl(.)39
b(This)25 b(operation)e(sends)i(a)h(mes-)1992 1984 y(sage)20
b(to)g(a)g(named)f(thread)g(\(or)g(task\))h(id)h(and)e(blocks)g(w)o
(aiting)h(for)1992 2084 y(a)28 b(response.)47 b(The)27
b(recei)n(v)o(e)g(phase)g(can)h(be)g(omitted,)h(allo)n(wing)1992
2184 y(message)20 b(sends)h(that)f(initiate)h(a)g(ne)n(w)f(thread)g(of)
g(control)g(within)1992 2283 y(the)g(recei)n(v)o(er)-5
b(.)2091 2392 y(As)48 b(part)f(of)f(the)h(speci\002cation)g(of)f(the)h
(recei)n(v)o(e)f(phase,)1992 2492 y(the)32 b(process)f(performing)f(a)i
(SendAndRecei)n(v)o(e)e(can)i(indicate)1992 2591 y(whether)15
b(it)i(will)h(accept)e(a)h(message)f(from)g(an)o(y)g(sender)f(\(an)i
(open)1992 2691 y(w)o(ait\))g(or)g(only)f(from)g(a)h(particular)f
(thread)g(\(a)h(closed)g(w)o(ait\).)24 b(This)1992 2791
y(enables)19 b(the)g(implementation)f(of)h(remote)g(procedure)e(calls:)
26 b(by)1992 2890 y(recei)n(ving)f(using)h(a)i(closed)f(w)o(ait,)i(the)
e(in)m(v)n(ok)o(er)e(of)i(the)g(RPC)i(is)1992 2990 y(assured)c(that)h
(the)g(ne)o(xt)f(incoming)f(message)i(will)g(be)g(recei)n(v)o(ed)1992
3089 y(from)19 b(the)h(in)m(v)n(ok)o(ed)e(thread.)2091
3198 y(The)40 b(payload)e(of)i(an)g(L4)g(IPC)h(operation)d(consists)i
(of)g(a)1992 3298 y(bounded)26 b(v)o(ector)h(of)i(\223immediate)f(w)o
(ords,)-6 b(\224)30 b(some)f(number)e(of)1992 3397 y(which)c(are)h
(guaranteed)e(to)i(be)g(transmitted)g(in)g(re)o(gisters.)36
b(This)1992 3497 y(w)o(ord)29 b(v)o(ector)f(is)j(optionally)d(follo)n
(wed)h(by)g(a)h(bounded)e(\223dope)1992 3597 y(v)o(ector)m(,)-6
b(\224)38 b(each)e(entry)f(of)h(which)g(can)g(specify)g(either)f(a)i
(byte)1992 3696 y(string)c(of)h(arbitrary)e(length)h(\(limited)h(by)f
(the)h(address)g(space)1992 3796 y(size\))15 b(or)g(an)g(address)g
(space)h(mapping)d(to)j(be)f(transferred.)21 b(Ignor)n(-)1992
3896 y(ing)29 b(some)h(complications)f(arising)g(from)h(scatter/gather)
e(sup-)1992 3995 y(port,)18 b(the)g(recei)n(v)o(e)g(speci\002cation)g
(must)g(include)g(corresponding)1992 4095 y(dope)g(v)o(ectors)h
(specifying)g(where)g(each)h(logical)f(component)f(of)1992
4194 y(the)i(message)g(is)h(to)f(be)g(recei)n(v)o(ed.)2091
4303 y(An)25 b(L4)g(message)g(whose)g(payload)e(is)j(fully)f(re)o
(gisterized)f(is)1992 4403 y(guaranteed)c(not)j(to)g(induce)f(an)h(e)o
(xception)f(in)h(either)g(sender)f(or)1992 4503 y(recipient.)55
b(T)m(ransmission)30 b(of)h(a)g(data)g(string)f(can)h(lead)g(to)g(re-)
1992 4602 y(cei)n(v)o(er)16 b(side)i(page)f(f)o(aults)h(that)f(are)h
(handled)e(by)h(user)n(-mode)f(f)o(ault)1992 4702 y(handlers.)2091
4811 y(In)k(general,)f(there)h(is)h(no)f(guarantee)f(that)h(the)h
(speci\002ed)f(des-)1992 4910 y(tination)27 b(process)h(is)h(in)f(the)g
(recei)n(v)o(e)f(state)i(at)g(the)f(time)h(of)f(the)1992
5010 y(IPC)g(operation.)44 b(T)-7 b(o)28 b(a)n(v)n(oid)f(inde\002nite)g
(blocking,)g(L4)g(in)m(v)n(oca-)1992 5109 y(tions)g(include)f(tw)o(o)h
(timeout)f(v)n(alues:)39 b(the)27 b(amount)e(of)i(time)g(to)1992
5209 y(w)o(ait)j(before)f(transmission)g(is)i(initiated,)h(and)d(the)h
(amount)f(of)1992 5309 y(time)17 b(that)g(can)f(be)h(spent)g(servicing)
f(page)g(f)o(aults.)24 b(If)17 b(either)g(time-)1992
5408 y(out)27 b(is)h(e)o(xceeded,)g(the)g(operation)d(is)k(aborted)d
(and)h(an)h(error)f(is)1929 5657 y(2)p eop
%%Page: 3 3
3 2 bop 0 91 a Fl(signaled)32 b(to)g(the)h(sending)e(process.)61
b(The)32 b(speci\002ed)g(timeout)0 191 y(can)20 b(be)g(in\002nite.)0
319 y Fh(V)-8 b(ulnerabilities)86 b Fl(The)24 b(tw)o(o)h(k)o(e)o(y)g
(weaknesses)f(of)h(the)g(L4)f(de-)0 419 y(sign)i(are)h(the)f(absence)g
(of)h(protection)d(in)j(the)g(speci\002cation)e(of)0
519 y(the)19 b(recipient)f(\(an)o(y)f(sender)h(may)g(in)m(v)n(ok)o(e)g
(an)o(y)g(process\))g(and)g(the)0 618 y(presence)32 b(of)g(timeouts)g
(in)h(the)g(IPC)g(interf)o(ace.)61 b(In)33 b(addition,)0
718 y(there)c(are)h(tw)o(o)g(minor)f(issues:)45 b(the)30
b(IPC)g(mechanism)f(re)n(v)o(eals)0 818 y(the)i(sender')-5
b(s)31 b(task)g(id)h(to)f(the)g(recipient,)i(and)d(the)i(widely)e(re-)0
917 y(ported)17 b(high-performance)e(Pentium)j(implementation)e(f)o
(ails)k(to)0 1017 y(sa)n(v)o(e)g(and)g(restore)g(se)o(gment)f(re)o
(gister)g(v)n(alues.)100 1118 y(The)32 b(absence)f(of)h(IPC)h
(protection)e(depri)n(v)o(es)g(a)h(service)g(of)0 1218
y(the)f(ability)g(to)g(restrict)g(its)h(callers.)58 b(A)31
b(hostile)g(process)g(may)0 1318 y(perform)24 b(denial)h(of)g(service)h
(attacks)g(by)f(repeatedly)f(in)m(v)n(oking)0 1417 y(operations)17
b(on)h(an)h(arbitrary)e(tar)o(get)g(process.)24 b(This)19
b(can)g(be)f(mit-)0 1517 y(igated)31 b(using)g(the)h(original)e
(\223clans)i(and)f(chiefs\224)g(mechanism)0 1617 y([23)o(],)21
b(b)n(ut)g(this)g(solution)f(imposes)g(signi\002cant)h(o)o(v)o(erhead)d
(on)i(all)0 1716 y(in)m(v)n(ocations.)51 b(A)30 b(more)f(ef)n
(\002cient)g(solution)g(proposed)e(in)j([22)o(])0 1816
y(is)d(to)g(allocate)f(one)f(serv)o(er)h(thread)f(per)h(client)g(and)g
(use)g(closed)0 1915 y(w)o(aits.)58 b(This)31 b(solution)f(requires)g
(all)i(service)e(applications)g(to)0 2015 y(accept)24
b(the)g(comple)o(xity)f(of)h(multithreading,)e(has)j(unfortunate)0
2115 y(implications)g(for)g(resource)g(consumption,)f(and)h(does)h(not)
f(ad-)0 2214 y(dress)i(the)h(problem)d(of)i(session)h(establishment)e
(for)h(such)g(ser)n(-)0 2314 y(vices.)71 b(An)36 b(e)o(xperimental)e
(design)h(modi\002cation)e(by)j(Jae)o(ger)0 2414 y(has)18
b(proposed)e(a)i(capability-lik)o(e)f(IPC)h(redirection)e(mechanism)0
2513 y([12)o(])j(that)g(pro)o(vides)f(access)h(control)f(and)h(renders)
f(the)h(recipient)0 2613 y(identity)c(opaque.)21 b(This)16
b(design)e(has)i(not)f(yet)g(been)g(incorporated)0 2712
y(into)25 b(the)g(L4)f(speci\002cation,)h(b)n(ut)g(is)h(e)o(xpected)d
(to)j(add)e(between)0 2812 y(20\045)17 b(\(typical\))g(and)g(50\045)g
(to)h(the)g(cost)g(of)f(an)g(L4)h(IPC)g(operation.)100
2914 y(The)i(timeout)g(mechanism)g(mitigates)g(certain)g(lo)n(w-cost)g
(de-)0 3013 y(nial)27 b(of)g(service)g(attacks,)i(b)n(ut)f(not)f(ef)n
(fecti)n(v)o(ely:)37 b(the)28 b(recei)n(ving)0 3113 y(serv)o(er)g
(thread)g(is)h(occupied)e(by)i(the)f(IPC)i(operation)d(until)h(the)0
3213 y(timeout)20 b(occurs.)25 b(The)c(presence)e(of)i(timeouts)f(in)h
(the)f(primiti)n(v)o(e)0 3312 y(IPC)29 b(speci\002cation)e(impedes)g
(reproducible)e(operation)h(unless)0 3412 y(w)o(orkloads)15
b(and)h(queueing)f(beha)n(vior)f(can)j(be)f(predicted.)22
b(T)m(ime-)0 3511 y(out)k(f)o(ailures)f(are)h(dif)n(\002cult)f(to)h
(test)h(in)f(real)g(systems,)h(and)f(ha)n(v)o(e)0 3611
y(the)20 b(potential)g(to)g(cascade)g(in)g(unpredictable)e(w)o(ays.)100
3713 y(While)32 b(the)g(L4)f(IPC)i(system)f(has)g(the)g(ability)f(to)h
(transmit)0 3812 y(multiple,)f(independently)26 b(labeled)i(strings,)k
(the)d(inclusion)f(of)0 3912 y(multiple)17 b(strings)g(has)g(little)i
(impact)d(on)h(vulnerability)-5 b(.)22 b(The)17 b(pri-)0
4012 y(mary)g(concern)f(in)i(string)g(transmission)f(is)i(page)e(f)o
(ault)h(handling)0 4111 y(rather)h(than)h(aggre)o(gate)e(string)i
(length)f(or)h(number)e(of)i(strings.)100 4213 y(It)43
b(is)h(debatable)e(whether)g(the)h(minor)f(issues)i(identi\002ed)0
4312 y(abo)o(v)o(e)18 b(should)g(be)h(vie)n(wed)g(as)h(signi\002cant)e
(vulnerabilities.)24 b(Re-)0 4412 y(v)o(ealing)g(sender)h(task)i
(identity)e(is)h(clearly)f(a)i(f)o(ailure)e(of)g(encap-)0
4512 y(sulation.)72 b(In)36 b(principle)e(this)j(is)g(unfortunate,)g(b)
n(ut)f(it)g(is)h(not)0 4611 y(clear)f(that)g(the)g(re)n(v)o(elation)e
(has)j(signi\002cant)e(security)h(conse-)0 4711 y(quences.)67
b(One)34 b(concern)f(is)i(that)g(re)n(v)o(ealing)e(the)h(caller)h(task)
0 4811 y(identity)16 b(demonstrates)f(authority)h(only)f(indirectly)-5
b(,)16 b(and)g(mak)o(es)0 4910 y(interposition)f(between)i(client)g
(and)f(serv)o(er)h(dif)n(\002cult)f([13)o(].)24 b(F)o(ail-)0
5010 y(ure)j(to)g(sa)n(v)o(e)g(and)f(restore)h(se)o(gment)f(re)o
(gisters)g(re)n(v)o(eals)h(the)g(un-)0 5109 y(derlying)c(interrupt)h(e)
n(v)o(ent)g(\003o)n(w)i(to)f(an)o(y)g(process)f(that)i(cares)f(to)0
5209 y(observ)o(e)d(it.)34 b(This)23 b(is)h(a)g(high-bandwidth)19
b(inw)o(ard)j(co)o(v)o(ert)g(chan-)0 5309 y(nel,)31 b(b)n(ut)e(the)g
(hole)g(could)f(be)h(straightforw)o(ardly)d(closed)j(with)0
5408 y(minor)19 b(alterations)h(to)g(the)g(implementation.)1992
91 y Fo(2.2)99 b(ER)m(OS)25 b(IPC)1992 260 y Fl(The)19
b(ER)m(OS)h(IPC)h(system)f(w)o(as)g(deri)n(v)o(ed)e(from)h(that)h(of)f
(K)n(e)o(yK)n(OS)1992 360 y([11)n(],)35 b(b)n(ut)d(has)g(been)g
(in\003uenced)e(by)i(v)n(arious)f(aspects)h(of)g(the)1992
459 y(L4)37 b(design.)78 b(ER)m(OS)38 b(implements)f(three)g(primiti)n
(v)o(e)g(in)m(v)n(oca-)1992 559 y(tions:)d Ft(S)t(E)t(N)t(D)26
b Fl(\(which)c(does)i(not)f(w)o(ait\),)k Ft(C)t(A)t(L)t(L)f
Fl(\(sends)d(and)g(en-)1992 659 y(ters)16 b(a)h(closed)f(w)o(ait\),)h
(and)h Ft(R)t(E)t(T)t(U)t(R)t(N)h Fl(\(sends)d(and)f(enters)h(an)h
(open)1992 758 y(w)o(ait\).)24 b(The)16 b(f)o(act)h(that)h(a)f(process)
f(is)i(in)f(an)g(open)f(or)h(a)g(closed)g(w)o(ait)1992
858 y(is)29 b(e)o(xplicitly)f(recorded)f(in)i(the)g(process)f(state)h
(of)g(the)g(w)o(aiting)1992 958 y(process.)2091 1074
y(In)23 b(contrast)g(to)h(the)f(L4)g(design,)g(the)h(open/closed)d(w)o
(ait)j(dis-)1992 1174 y(tinction)k(in)i(ER)m(OS)f(e)o(xpresses)g(a)h
(restriction)e(on)h(the)h(capabil-)1992 1273 y(ity)f(type)g(that)h
(must)f(be)h(in)m(v)n(ok)o(ed)d(rather)i(than)g(the)g(process)g(id)1992
1373 y(of)23 b(the)h(in)m(v)n(ok)o(er)-5 b(.)34 b(A)24
b(recei)n(ving)f(process)g(in)h(the)g Fm(available)e
Fl(state)1992 1473 y(\(the)k(open)g(w)o(ait\))h(must)f(be)h(in)m(v)n
(ok)o(ed)e(using)h(a)h Fm(start)h(capability)1992 1572
y Fl(to)h(the)g(recei)n(ving)f(process.)52 b(If)29 b(the)g(recei)n
(ving)f(process)h(is)h(not)1992 1672 y(in)h(the)h(a)n(v)n(ailable)f
(state,)36 b(this)c(in)m(v)n(ocation)e(will)i(block.)59
b(A)32 b(re-)1992 1771 y(cei)n(ving)17 b(process)h(in)h(the)g
Fm(w)o(aiting)g Fl(state)h(\(the)e(closed)g(w)o(ait\))i(must)1992
1871 y(be)d(in)m(v)n(ok)o(ed)e(using)i(a)g Fm(resume)h(capability)e
Fl(to)h(the)g(recei)n(ving)f(pro-)1992 1971 y(cess.)24
b(Resume)17 b(capabilities)f(are)h(produced)d(by)j(the)h
Ft(C)t(A)t(L)t(L)h Fl(oper)n(-)1992 2070 y(ation)c(and)g(are)g
(consumed)f(when)h(in)m(v)n(ok)o(ed.)21 b(The)15 b(process)g(model)1992
2170 y(guarantees)f(that)i(if)g(a)h(resume)e(capability)g(e)o(xists)h
(to)h(a)f(gi)n(v)o(en)f(pro-)1992 2270 y(cess,)20 b(that)h(process)e
(is)i(in)g(the)f(w)o(aiting)g(state.)25 b(This)c(ensures)e(that)1992
2369 y(in)m(v)n(oking)g(a)i(resume)g(capability)f(will)i(ne)n(v)o(er)e
(block)g(w)o(aiting)h(for)1992 2469 y(interprocess)d(rendezv)n(ous.)
2091 2585 y(The)25 b(payload)e(of)h(an)h(ER)m(OS)g(IPC)h(operation)d
(contains)h(four)1992 2685 y(re)o(gisters,)j(four)f(capabilities,)h
(and)f(a)i(bounded)c(string.)44 b(F)o(orth-)1992 2784
y(coming)25 b(enhancements)h(will)i(remo)o(v)o(e)d(the)j(string)f
(bound)e(and)1992 2884 y(pro)o(vide)d(L4-lik)o(e)h(scatter/gather)g
(support.)35 b(In)24 b(contrast)g(to)g(L4,)1992 2984
y(an)f(ER)m(OS)g(process)g(must)g(hold)g(a)g(capability)g(to)g(the)g
(process)g(it)1992 3083 y(wishes)d(to)h(in)m(v)n(ok)o(e.)j
(Capabilities)d(are)f(named)g(indirectly)f(in)i(the)1992
3183 y(in)m(v)n(ocation)f(by)j(specifying)e(their)h(inde)o(x)g(in)h(a)g
(k)o(ernel-managed)1992 3283 y(per)n(-process)k(capability)h(list.)53
b(ER)m(OS)30 b(pro)o(vides)d(only)i(limited)1992 3382
y(means)j(for)h(mapping)e(transfers:)51 b(the)33 b(sender)g(can)g(e)o
(xplicitly)1992 3482 y(construct)e(a)h(mapping)f(structure)g(and)h
(transmit)g(a)h(capability)1992 3581 y(to)c(this)h(structure)e(to)i
(the)f(recipient.)51 b(ER)m(OS)30 b(also)g(pro)o(vides)d(a)1992
3681 y(translucent)17 b(forw)o(arding)e(object)j(kno)n(wn)f(as)h(a)h
Fm(wrapper)f Fl(that)g(al-)1992 3781 y(lo)n(ws)i(capabilities)g(to)g
(be)g(selecti)n(v)o(ely)g(rescinded.)2091 3897 y(As)25
b(with)g(L4,)g(an)f(ER)m(OS)h(in)m(v)n(ocation)e(whose)h(payload)e
(con-)1992 3997 y(sists)f(only)d(of)h(re)o(gisters)g(and)g
(capabilities)h(is)g(guaranteed)d(not)i(to)1992 4096
y(induce)24 b(an)h(e)o(xception)f(in)h(either)g(sender)g(or)g
(recipient.)39 b(T)m(rans-)1992 4196 y(mission)15 b(of)h(a)h(data)e
(string)h(can)g(lead)g(to)g(page)f(f)o(aults)h(in)g(the)g(recip-)1992
4296 y(ient)26 b(if)g(the)g(recei)n(v)o(e)f(re)o(gion)f(has)j(not)e
(been)h(properly)e(prepared)1992 4395 y(by)k(the)h(recipient.)50
b(If)29 b(such)f(a)i(page)e(f)o(ault)h(w)o(ould)f(require)g(the)1992
4495 y(in)m(v)n(ocation)21 b(of)j(a)g(user)n(-mode)e(page)h(f)o(ault)h
(handler)m(,)f(and)g(the)h(in-)1992 4595 y(v)n(ocation)15
b(is)j(a)g(resume)e(capability)g(in)m(v)n(ocation,)f(the)i(transmitted)
1992 4694 y(string)27 b(is)i(truncated.)47 b(This)28
b(beha)n(vior)e(guards)h(against)h(hostile)1992 4794
y(clients)20 b(that)g(seek)h(to)f(block)f(a)i(serv)o(er)e
(inde\002nitely)-5 b(.)2091 4910 y(The)27 b(interactions)f(between)g
(ER)m(OS)i(in)m(v)n(ocation)d(types)i(and)1992 5010 y(capability)22
b(types)h(allo)n(w)h(tw)o(o)f(mutually)g(trusting)f(processes)h(to)1992
5109 y(establish)16 b(an)f(\223e)o(xtended)f(mutual)h(e)o(xclusion\224)
f(using)i(co-routine)1992 5209 y(style)21 b Ft(C)t(A)t(L)t(L)g
Fl(operations.)i(Process)c Fg(A)h Fl(performs)e(a)j Ft(C)t(A)t(L)t(L)g
Fl(on)e Fg(B)t Fl(.)1992 5309 y(Instead)27 b(of)g(returning,)g
Fg(B)33 b Fl(performs)26 b(a)k Ft(C)t(A)t(L)t(L)g Fl(on)d(the)h(resume)
1992 5408 y(capability)22 b(to)h Fg(A)p Fl(.)36 b(The)23
b(tw)o(o)g(processes)h(continue)d(in)j(this)g(f)o(ash-)1929
5657 y(3)p eop
%%Page: 4 4
4 3 bop 0 91 a Fl(ion)17 b(until)f(both)h(are)g(done,)f(and)g(the)h
(\002nal)h(in)m(v)n(ocation)d(performed)0 191 y(is)24
b(a)h Ft(R)t(E)t(T)t(U)t(R)t(N)h Fl(operation.)k(Until)24
b(this)f(\002nal)g(in)m(v)n(ocation)e(is)i(per)n(-)0
291 y(formed,)32 b(whiche)n(v)o(er)d(party)h(is)h(block)o(ed)f(is)i(in)
f(a)g(closed)g(w)o(ait.)0 390 y(This)24 b(ensures)g(that)g(third-party)
d(in)m(v)n(ocations)i(cannot)g(interrupt)0 490 y(the)d(transaction)f
(in)i(progress.)0 629 y Fh(V)-8 b(ulnerabilities)84 b
Fl(The)24 b(k)o(e)o(y)f(weakness)g(of)g(the)h(ER)m(OS)g(design)0
729 y(is)18 b(its)h(requirement)c(that)i(the)g(client)h(kno)n(w)e(in)h
(adv)n(ance)f(an)h(upper)0 828 y(bound)25 b(on)h(the)g(size)h(of)g(an)o
(y)e(message)i(returned)d(by)j(a)g(serv)o(er)-5 b(.)1877
798 y Fk(2)0 928 y Fl(This)23 b(is)g(a)g(functional)d(rather)i(than)g
(a)h(security)e(f)o(ailing,)i(b)n(ut)f(it)h(is)0 1028
y(rather)h(a)h(nuisance)f(when)g(implementing)e(a)k(language-neutral)0
1127 y(capability)19 b(interf)o(ace.)100 1234 y(The)k(ER)m(OS)i
(truncation)d(rule)i(has)g(been)f(mis-characterized)0
1334 y(as)g(a)f(correctness)f(\003a)o(w)h(by)f(F)o(ord)g
Fn(et)i(al.)30 b Fl([7)o(].)g(In)22 b(f)o(act,)g(it)h(re\003ects)0
1434 y(a)j(conscious)f(decision)g(that)h(serv)o(ers)f(are)g(not)h
(obligated)d(to)j(re-)0 1533 y(turn)20 b(correct)g(data)h(to)g(hostile)
g(clients.)28 b(Liedtk)o(e)20 b(also)i(found)d(the)0
1633 y(truncation)h(decision)h(surprising)f(\(personal)h
(communication\).)0 1732 y(Discussion)k(of)f(its)i(rationale)e
(resulted)g(in)g(the)h(introduction)d(of)0 1832 y(separate)27
b(page)f(f)o(ault)i(timeouts)e(into)i(the)f(L4)g(IPC)h(system.)46
b(In)0 1932 y(the)30 b(absence)g(of)g(either)g(truncation)e(or)i
(timeouts,)j(deli)n(v)o(ery)28 b(is)0 2031 y(assured)f(at)g(the)g(cost)
h(of)f(e)o(xposure)e(to)i(denial)g(of)g(service.)45 b(W)-7
b(e)0 2131 y(note)15 b(that)h(gi)n(v)o(en)f(a)h(choice)f(between)g(e)o
(xposure,)g(truncation,)g(and)0 2231 y(timeout)21 b(there)f(are)h
(really)g(no)g(desirable)g(outcomes.)27 b(The)20 b(solu-)0
2330 y(tion)c(that)g(we)g(are)g(adopting)e(in)i(the)g(ne)o(xt)f
(generation)f(ER)m(OS)j(sys-)0 2430 y(tem)f(is)g(feasible)g(only)f(in)g
(capability-based)f(systems,)j(and)e(relies)0 2529 y(hea)n(vily)20
b(on)h(ER)m(OS')-5 b(s)22 b(ability)f(to)g(f)o(actor)f(resource)g(and)g
(trust)h(de-)0 2629 y(pendencies.)0 2913 y Fr(3)119 b(Asymmetric)29
b(T)-9 b(rust)0 3052 y Fl(A)31 b(k)o(e)o(y)-5 b(,)33
b(under)n(-recognized)26 b(requirement)j(in)i(IPC)h(systems)f(is)0
3152 y(the)e(ability)f(to)h(support)e(asymmetric)h(or)h(quali\002ed)e
(trust)i(rela-)0 3252 y(tionships)k(between)h(tw)o(o)g(communicating)d
(processes.)66 b(This)0 3351 y(occurs)21 b(whene)n(v)o(er)e(multiple)i
(client)h(applications)e(call)i(a)g(single)0 3451 y(serv)o(er)f
(application,)g(and)h(is)h(especially)f(acute)g(when)g(the)g(com-)0
3551 y(mon)29 b(\(shared\))f(application)h(is)h(a)h(reference)d
(monitor)-5 b(.)53 b(While)0 3650 y(the)21 b(clients)g(trust)f(the)h
(serv)o(er)f(to)h(process)f(their)g(requests,)g(a)h(cor)n(-)0
3750 y(rect)29 b(serv)o(er)f(is)h(presented)f(with)h(a)g(curious)e(set)
j(of)e(con\003icting)0 3849 y(objecti)n(v)o(es:)83 4038
y Fi(\017)41 b Fl(It)17 b(must)f(respond)f(to)h(the)g(client)h
(requests)e(according)g(to)h(the)166 4137 y(requirements)k(of)h(its)i
(interf)o(ace)e(and)g(operational)f(speci\002-)166 4237
y(cation.)83 4353 y Fi(\017)41 b Fl(It)24 b(cannot)f(trust)g(that)h(a)g
(gi)n(v)o(en)f(client)g(will)i(f)o(aithfully)d(e)o(x)o(e-)166
4453 y(cute)c(its)g(part)g(in)f(the)h(application-le)n(v)o(el)d(in)m(v)
n(ocation)h(proto-)166 4552 y(col.)24 b(In)16 b(particular)m(,)g(no)g
(assumptions)g(can)h(be)g(made)f(by)g(the)166 4652 y(serv)o(er)24
b(about)g(the)h(possibility)f(of)h(client-induced)d(block-)166
4752 y(ing)17 b(unless)g(blocking)e(is)j(precluded)d(by)i(the)g
(primiti)n(v)o(e)e(IPC)166 4851 y(mechanism.)p 0 4935
764 4 v 0 4991 a Fj(2)66 5014 y Ft(While)21 b(it)f(has)g(not)g(been)g
(emphasized)i(in)e(prior)g(publications)j(on)c(the)h(ER)m(OS)66
5093 y(IPC)h(system,)f(the)h(ER)m(OS)f(system)h(includes)h(a)e
(translucent)k(forw)o(arding)e(ob-)66 5172 y(ject.)g(The)17
b(original)i(purpose)e(of)g(the)g(translucent)j(forw)o(arder)e(w)o(as)f
(to)g(support)66 5251 y(selecti)n(v)o(e)k(rescinding)f(of)d(client)j
(access.)j(Selecti)n(v)o(e)e(re)n(v)o(ocation)g(of)c(this)h(kind)66
5329 y(can)j(be)g(used)f(defensi)n(v)o(ely)j(to)d(re)n(v)o(ok)o(e)i
(hostile)g(sessions)e(in)g(the)h(e)n(v)o(ent)h(of)e(re-)66
5408 y(quest)e(\003ooding)g(attacks.)1992 91 y Fl(A)26
b(hostile)g(client)g(might)f(attempt)h(denial)f(of)h(service)g(on)f
(other)1992 191 y(clients)15 b(simply)h(by)f(calling)g(a)h(serv)o(er)f
(and)g(blocking)f(inde\002nitely)1992 291 y(in)k(a)h(non-recei)n(ving)c
(process)j(state,)h(causing)f(the)g(serv)o(er)g(in)g(turn)1992
390 y(to)d(become)g(block)o(ed)f(when)i(it)g(attempts)g(to)g(reply)-5
b(.)22 b(W)-7 b(e)17 b(will)f(refer)1992 490 y(to)k(this)h(type)e(of)h
(a)h(client)f(as)h(a)g Fm(def)o(ecting)e(client)p Fl(.)2091
589 y(F)o(our)h(basic)h(design)f(features)g(ha)n(v)o(e)g(been)g
(attempted)g(in)h(v)n(ar)n(-)1992 689 y(ious)f(IPC)h(designs)e(to)i
(manage)e(and)g(mitigate)h(this)h(problem:)1992 809 y
Fh(Buffering)75 b Fl(Mach)15 b([1)o(],)h(along)e(with)i(most)f(early)g
(IPC)h(systems,)1992 908 y(implements)24 b(message)i(b)n(uf)n(fering.)
40 b(Buf)n(fer)24 b(blocks)i(are)f(k)o(ernel)1992 1008
y(allocated,)i(which)f(ef)n(fecti)n(v)o(ely)e(con)m(v)o(erts)h(a)i
(well-localized)e(at-)1992 1108 y(tack)31 b(on)h(a)g(single)f(serv)o
(er)g(into)h(a)g(global)f(denial)g(of)h(resource)1992
1207 y(attack)20 b(on)f(the)i(entire)e(operating)g(system.)1992
1327 y Fh(Multithr)o(eading)88 b Fl(L4)30 b([20)n(,)g(21)o(])g(and)f
(Mach)g(support)f(multi-)1992 1427 y(threaded)f(serv)o(ers.)51
b(In)29 b(L4,)i(threads)d(are)h(e)o(xplicitly)f(allocated)1992
1526 y(resources,)j(and)e(a)h(gi)n(v)o(en)f(serv)o(er)g(will)i(e)n(v)o
(entually)d(run)h(out)h(of)1992 1626 y(them.)24 b(Multithreading)16
b(is)k(therefore)d(not)h(ef)n(fecti)n(v)o(e)f(against)i(the)1992
1726 y(denial)f(of)g(resource)f(attack,)i(b)n(ut)g(it)g
Fn(does)f Fl(ensure)g(that)h(the)g(attack)1992 1825 y(also)26
b(pressures)f(the)h(k)o(ernel)f(scheduler)m(,)h(e)o(xpanding)d(the)j
(scope)1992 1925 y(of)19 b(the)i(vulnerability)-5 b(.)1992
2045 y Fh(T)f(runcation)91 b Fl(ER)m(OS)32 b([30)o(])g(ensures)f(that)h
(all)h(serv)o(er)e(replies)1992 2144 y(are)20 b(\223prompt\224)f(by)h
(virtue)f(of)i(its)g(IPC)g(speci\002cation.)k(A)d Fm(prompt)1992
2244 y Fl(in)m(v)n(ocation)c(is)k(one)e(that)h(cannot)e(be)i(block)o
(ed)e(by)i(the)f(actions)h(of)1992 2343 y(an)j(untrusted)e(party)-5
b(.)36 b(The)24 b(ER)m(OS)g(process)g(model)f(guarantees)1992
2443 y(that)18 b(the)g(client)f(is)i(in)f(the)g(proper)f(state)h(when)g
(the)g(serv)o(er)f(replies)1992 2543 y(using)22 b(a)h(resume)f
(capability)-5 b(.)31 b(Ho)n(we)n(v)o(er)m(,)22 b(this)h(is)h(only)e(a)
h(partial)1992 2642 y(solution.)52 b(Unless)30 b(care)g(is)g(tak)o(en,)
i(user)n(-le)n(v)o(el)c(pagers)h(can)h(be)1992 2742 y(used)16
b(by)h(a)h(hostile)f(client)g(to)g(block)g(a)g(replying)f(serv)o(er)g
(in)h(a)h(non-)1992 2842 y(returning)25 b(user)n(-le)n(v)o(el)i(page)g
(f)o(ault)g(handler)-5 b(.)46 b(T)-7 b(o)28 b(preclude)e(this)1992
2941 y(attack,)i(ER)m(OS)f(truncates)g(the)g(message)g(and)f(reports)g
(the)h(f)o(act)1992 3041 y(of)c(truncation)g(to)h(the)g(client)h(whene)
n(v)o(er)d(a)i(user)n(-mode)f(handler)1992 3140 y(w)o(ould)g(need)g(to)
h(be)g(in)m(v)n(ok)o(ed.)34 b(De\002ned)23 b(pages)h(that)g(ha)n(v)o(e)
f(been)1992 3240 y(remo)o(v)o(ed)f(by)j(the)g(single-le)n(v)o(el)f
(store)h(implementation)e(do)i(not)1992 3340 y(result)17
b(in)h(truncation,)e(because)h(the)g(k)o(ernel)g(is)i(trusted)e(to)h
(supply)1992 3439 y(them)h(promptly)-5 b(.)1992 3559
y Fh(T)o(imeouts)75 b Fl(L4)15 b([20)o(,)h(21)o(])f(includes)g(a)h
(timeout)e(speci\002cation)h(as)1992 3659 y(part)20 b(of)g(each)g(in)m
(v)n(ocation,)f(with)h(reserv)o(ed)f(v)n(alues)i(to)f(mean)g(\223do)
1992 3758 y(not)e(w)o(ait\224)h(and)f(\223w)o(ait)h(fore)n(v)o(er)-5
b(.)f(\224)22 b(While)d(a)g(timeout)f(pre)n(v)o(ents)f(to-)1992
3858 y(tal)22 b(blockage)e(of)h(a)h(serv)o(er)m(,)f(a)h(small)g(number)
e(of)i(hostile)f(clients)1992 3958 y(can)h(e)o(xploit)g(the)h(use)g(of)
g(a)g(serv)o(er)n(-side)f(timeout)g(to)h(implement)1992
4057 y(se)n(v)o(ere)c(denial)h(of)g(service)f(against)h(other)f
(clients.)2091 4157 y(A)35 b(summary)f(of)g(which)g(features)h(are)f
(included)f(in)i(com-)1992 4256 y(monly)18 b(referenced)g(IPC)j
(systems)g(is)g(gi)n(v)o(en)e(in)h(T)-7 b(able)21 b(1.)p
2165 4368 1541 4 v 2165 4384 V 2215 4454 a Fh(F)n(eatur)o(e)323
b(Mach)99 b(L4)124 b(ER)n(OS)2215 4554 y Fl(Buf)n(fering)275
b(Y)-8 b(es)181 b(No)119 b(No)2215 4653 y(Multithreading)97
b(Y)-8 b(es)181 b(No)119 b(V)-5 b(ia)20 b(Retry)2215
4753 y(T)m(runcation)234 b(No)200 b(No)119 b(Y)-8 b(es)2215
4853 y(T)m(imeouts)286 b(No)200 b(Y)-8 b(es)100 b(No)p
2165 4886 V 2165 4902 V 2091 5054 a Ff(T)-7 b(ab)o(le)15
b(1.)g(Summar)q(y)37 b(of)e(def)o(ensive)i(f)o(eatures)f(in)g(com\255)
2399 5154 y(monl)o(y)23 b(ref)o(erenced)g(IPC)h(implementations.)1929
5657 y Fl(4)p eop
%%Page: 5 5
5 4 bop 0 91 a Fo(3.1)99 b(Effect)27 b(of)d(Buffering)0
238 y Fl(As)i(we)f(ha)n(v)o(e)f(already)f(mentioned,)h(k)o
(ernel-implemented)d(IPC)0 337 y(b)n(uf)n(fering)h(creates)i
(opportunity)e(for)h(global)h(denial)f(of)h(service)0
437 y(by)32 b(performing)d(a)j(denial)g(of)g(resource)f(attack)g(on)h
(the)g(a)n(v)n(ail-)0 537 y(able)20 b(k)o(ernel)f(b)n(uf)n(fers.)24
b(Because)d(of)f(Mach')-5 b(s)20 b(lazy)g(cop)o(y)f(feature,)0
636 y(which)29 b(performs)f(lar)o(ge)h(copies)g(using)g(transparently)f
(k)o(ernel-)0 736 y(implemented)15 b(cop)o(y)h(on)g(write)h(mappings,)f
(attacking)g(the)g(Mach)0 835 y(IPC)30 b(system)f(in)g(this)g(w)o(ay)g
(requires)f(f)o(airly)h(lar)o(ge)f(copies:)42 b(the)0
935 y(pressure)26 b(on)h(pages)g(is)g(con)m(v)o(erted)e(into)i
(pressure)f(on)h(page)f(ta-)0 1035 y(bles.)55 b(When)30
b(implemented)e(on)i(most)g(hierarchical)f(memory)0 1134
y(management)f(architectures,)j(a)f(small)h(number)d(of)i(cooperat-)0
1234 y(ing)h(hostile)g(processes)g(can)g(e)o(xhaust)f(Mach)h(k)o(ernel)
g(memory)0 1334 y(on)18 b(a)h(32-bit)e(machine)g(by)h(performing)d
(misaligned)j(copies)g(of)g(a)0 1433 y(2)g(gigabyte)e(re)o(gion;)h
(each)h(cop)o(y)f(allocates)h(enough)e(page)i(tables)0
1533 y(to)i(consume)f(8)i(me)o(gabytes)d(of)i(k)o(ernel)f(memory)-5
b(.)100 1637 y(T)e(o)31 b(perpetuate)f(this)i(attack,)i(the)d
(attacking)g(process)g(need)0 1737 y(ne)n(v)o(er)j(acquire)g(the)h
(full)g(2)g(gigabytes.)68 b(By)36 b(starting)e(with)i(a)0
1837 y(smaller)29 b(re)o(gion)e(whose)h(size)h(just)g(e)o(xceeds)f(the)
h(k)o(ernel')-5 b(s)28 b(pol-)0 1936 y(ic)o(y)c(threshold)g(for)g(cop)o
(y)g(on)g(write)h(transfer)f(a)h(hostile)g(process)0
2036 y(can)d(use)g(multiple)g(transfers)g(to)g(create)g(the)g(lar)o(ge)
g(re)o(gion)e(with-)0 2136 y(out)28 b(actually)g(holding)f(a)i(lar)o
(ge)f(number)f(of)h(data)h(pages.)49 b(The)0 2235 y(essence)19
b(of)g(the)g(problem)f(is)i(that)f(neither)g(party)f(in)i(the)f
(transac-)0 2335 y(tion)h(is)h(\223char)o(ged\224)d(for)h(their)h
(mapping)f(pages)g(by)h(the)g(k)o(ernel.)100 2439 y(While)27
b(the)f(additional)f(copies)h(imposed)g(by)g(b)n(uf)n(fering)e(are)0
2539 y(undesirable,)38 b(the)e Fn(security)g Fl(problem)e(with)i(b)n
(uf)n(fering)d(arises)0 2639 y(from)27 b(a)h(misattrib)n(ution)e(of)h
(b)n(urden)f(\(cost\).)47 b(By)28 b(f)o(ailing)f(to)h(at-)0
2738 y(trib)n(ute)17 b(the)g(cost)g(of)g(b)n(uf)n(fer)f(storage)h(to)g
(an)g(appropriate)e(process,)0 2838 y(the)27 b(k)o(ernel)f(becomes)g
(open)g(to)i(attack.)45 b(The)27 b(V)-11 b(AX/VMM)27
b(se-)0 2937 y(curity)d(monitor)g(mitigated)g(this)h(issue)h(using)e
(memory)g(quotas)0 3037 y([18)o(],)29 b(b)n(ut)e(a)h(quota-based)e
(approach)f(is)j(not)g(practical)f(in)g(ef)n(\002-)0
3137 y(cient)j(IPC)i(systems.)56 b(Introduction)27 b(of)j(such)h(a)g
(quota)e(mech-)0 3236 y(anism)37 b(into)f(a)h(synchronous)d(IPC)j
(system)g(must)g(e)n(v)o(entually)0 3336 y(result)i(in)g(the)h(deli)n
(v)o(ery)d(of)i(an)g(allocation)f(f)o(ault)h(to)h(a)f(user)n(-)0
3436 y(mode)15 b(e)o(xception)g(handler)m(,)g(which)h(is)h(e)o(xactly)f
(the)g(problem)f(that)0 3535 y(ER)m(OS)21 b(f)o(aces)f(with)g(user)n
(-supplied)f(page)g(f)o(ault)h(handlers.)100 3640 y(The)27
b(alternati)n(v)o(e)f(is)i(to)g(implement)e(an)i(IPC)g(primiti)n(v)o(e)
e(that)0 3739 y(operates)19 b(o)o(v)o(er)f(b)n(uf)n(fered)g(channels)h
(in)h(pipe-lik)o(e)f(f)o(ashion.)24 b(This)0 3839 y(approach)17
b(abandons)g(essentially)i(all)h(of)f(the)g(IPC)h(performance)0
3939 y(adv)n(ances)d(of)i(the)g(last)g(20)f(years,)h(and)f(the)h
(resulting)f(IPC)h(primi-)0 4038 y(ti)n(v)o(e)g(is)h(too)e(slo)n(w)h
(to)h(support)d(an)i(adequate)f(de)o(gree)f(of)i(compart-)0
4138 y(mentalization.)36 b(Neither)24 b(L4)g(nor)f(ER)m(OS)i
(implements)e(b)n(uf)n(fer)n(-)0 4238 y(ing)31 b(in)h(the)f(k)o(ernel,)
i(and)e(it)h(is)h(no)n(w)e(generally)f(accepted)g(that)0
4337 y(b)n(uf)n(fering)16 b(should)h(not)h(be)g(included)f(in)i(the)f
(design)g(of)g(a)g(k)o(ernel-)0 4437 y(le)n(v)o(el)i(IPC)h(primiti)n(v)
o(e.)0 4664 y Fo(3.2)99 b(Effect)27 b(of)d(Multithr)n(eading)0
4811 y Fl(The)15 b(ef)n(fect)g(of)h(multithreading)d(on)i(IPC)h(denial)
f(of)g(service)h(tak)o(es)0 4910 y(tw)o(o)26 b(forms.)39
b(If)25 b(ne)n(w)g(threads)g(are)g(allocated)f(transparently)f(by)0
5010 y(the)30 b(k)o(ernel,)h(there)e(is)i(an)e(implied)g(denial)g(of)h
(resource)e(attack)0 5109 y(by)33 b(e)o(xhausting)f(k)o(ernel)h(memory)
-5 b(.)63 b(If)34 b(threads)f(are)h(allocated)0 5209
y(e)o(xplicitly)27 b(by)g(the)h(serv)o(er)g(process,)h(then)e(the)h
(attack)g(requires)0 5309 y Fg(N)33 b Fl(copies)23 b(of)g(the)h
(hostile)f(client,)h(where)f Fg(N)33 b Fl(is)24 b(the)g(number)d(of)0
5408 y(a)n(v)n(ailable)f(serv)o(er)f(threads.)2091 91
y(Multithreading)i(is)j(required)e(in)h(certain)g(serv)o(ers,)g(b)n(ut)
h(from)1992 191 y(an)e(assurance)f(perspecti)n(v)o(e)g(it)i(is)g(best)f
(a)n(v)n(oided)g(on)g(comple)o(xity)1992 291 y(grounds.)43
b(Where)27 b(a)g(single-threaded)d(serv)o(er)i(is)i(feasible,)h(the)
1992 390 y(comple)o(xity)15 b(of)i(concurrenc)o(y)d(management)h(is)k
(eliminated)d(and)1992 490 y(assurance)j(of)h(the)g(serv)o(er)f(is)j
(more)d(easily)h(achie)n(v)o(ed.)2091 594 y(L4)c(pro)o(vides)e
(multithreading-a)o(w)o(are)e(IPC)17 b(in)f(the)g(microk)o(er)n(-)1992
694 y(nel.)24 b(ER)m(OS)18 b(will)g(shortly)f(implement)g(a)j
Ft(R)t(E)t(T)t(RY)h Fl(operation)15 b(that)1992 794 y(allo)n(ws)g(a)h
(service)g(to)f(force)g(a)h(caller)f(to)h(re-perform)d(its)j(last)h(in)
m(v)n(o-)1992 893 y(cation)25 b(on)g(a)h(service-supplied)d(capability)
-5 b(.)40 b(This)26 b(mechanism)1992 993 y(allo)n(ws)c(an)g(ER)m(OS)h
(service)f(to)h(selecti)n(v)o(ely)e(block)h(and)g(unblock)1992
1092 y(callers)k(in)h(the)g(k)o(ernel)e(after)h(e)o(xamining)f(their)h
(request.)43 b(Most)1992 1192 y(cases)23 b(of)f(multiple)o(xing)e(and)i
(out)h(of)f(order)f(return)h(can)g(be)g(han-)1992 1292
y(dled)g(using)g(only)g(a)h(single)g(service)f(thread)g(by)h(le)n(v)o
(eraging)d(this)1992 1391 y(mechanism.)1992 1618 y Fo(3.3)99
b(Effect)26 b(of)f(T)-7 b(runcation)1992 1764 y Fl(T)m(runcation)19
b(imposes)i(a)h(subtle)g(requirement)d(on)i(all)i(object)e(in-)1992
1864 y(terf)o(aces:)33 b(an)24 b(upper)f(bound)g(on)h(the)g(length)g
(of)g(the)g(reply)g(must)1992 1964 y(be)19 b(kno)n(wn)f(by)g(the)i
(client)f(at)h(the)f(time)h(of)f(the)g(call)h(so)f(that)h(it)g(can)1992
2063 y(pre-probe)c(the)j(recei)n(v)o(e)f(area)i(to)f(ensure)f(that)i
(needed)e(pages)h(are)1992 2163 y(de\002ned.)32 b(This)23
b(is)h(an)f(impediment)f(for)g(operations)g(that)h(return)1992
2262 y(\(e.g.\))46 b(v)o(ectors)27 b(or)h(strings,)h(as)g(it)g(is)f
(common)e(for)i(both)f(to)h(be)1992 2362 y(dynamically)e(sized.)51
b(In)28 b(the)h(general)e(case,)k(neither)d(of)g(these)1992
2462 y(types)f(can)g(safely)h(be)g(used)f(as)h(the)g(return)f(v)n(alue)
g(from)f(an)i(in-)1992 2561 y(terprocess)18 b(call)j(unless)e(the)h
(underlying)d(IPC)k(system)f(supports)1992 2661 y(dynamically)e(sized)i
(return)f(v)n(alues.)2091 2765 y(ER)m(OS)i(inherited)e(its)i
(truncation)e(approach)f(from)h(K)n(e)o(yK)n(OS)1992
2865 y([11)n(])h(and)g(it)h(has)f(seemed)f(adequate)g(for)h(man)o(y)e
(years.)25 b(W)-7 b(e)21 b(ha)n(v)o(e)1992 2965 y(lately)f(come)h(to)g
(feel)f(that)h(it)h(is)g(problematic.)j(Se)n(v)o(eral)20
b(changes)1992 3064 y(in)g(the)g(ER)m(OS)g(IPC)h(system)f(o)o(v)o(er)f
(the)h(years)g(ha)n(v)o(e)f(combined)f(to)1992 3164 y(alter)i(our)f
(vie)n(w:)2054 3366 y(1.)41 b(The)32 b(e)o(xpansion)e(of)i(the)h(K)n(e)
o(yK)n(OS)f([11)n(])h(one)f(page)g(IPC)2158 3466 y(payload)27
b(limit)i(to)f(64)g(kilobytes)g(in)h(ER)m(OS)g(reduced)e(the)2158
3565 y(length)19 b(pressure)h(on)h(messages,)f(and)h(started)f(us)h
(thinking)2158 3665 y(about)30 b(ho)n(w)i(to)g(map)f(CORB)m(A-lik)o(e)i
(object)e(in)m(v)n(ocations)2158 3764 y(directly)19 b(onto)g(the)i
(primiti)n(v)o(e)d(in)m(v)n(ocation)h(mechanism.)2054
3881 y(2.)41 b(This)19 b(in)g(turn)f(led)h(to)g(a)g(paper)f(design,)h
(to)g(be)f(implemented)2158 3980 y(in)28 b(the)h(ne)o(xt)f(round)f(of)i
(ER)m(OS)g(IPC)g(modi\002cations,)g(that)2158 4080 y(remo)o(v)o(es)23
b(the)h(string)h(length)f(bound)e(entirely)i(\(subject)g(to)2158
4180 y(the)c(limits)h(of)f(the)g(address)g(space)g(size\).)2054
4296 y(3.)41 b(The)62 b(subsequent)g(design)g(and)g(implementation)f
(of)2158 4395 y(CapIDL,)36 b(which)h(pro)o(vides)e(a)j
(language-neutral)c(inter)n(-)2158 4495 y(f)o(ace)17
b(de\002nition)g(language)f(for)h(capabilities,)h(dre)n(w)f(our)g(at-)
2158 4595 y(tention)i(to)i(the)f(f)o(act)h(that)g(unbounded)c
(dynamically)h(sized)2158 4694 y(v)o(ectors)37 b(cannot)g(be)i
(supported)d(if)j(the)f(recipient)g(must)2158 4794 y(kno)n(w)19
b(the)h(message)g(size)h(in)f(adv)n(ance.)2054 4910 y(4.)41
b(Our)18 b(desire)h(to)h(use)f(E)h([25)n(],)g(a)g(capability-based)c
(scripting)2158 5010 y(language,)25 b(as)h(a)g(scripting)f(language)f
(for)h(ER)m(OS)h(objects)2158 5109 y(led)i(us)h(to)f(introduce)f(a)h
(standard)g Fe(GetSignature\(\))2158 5209 y Fl(operation)21
b(on)i(all)h(conforming)d(capabilities.)34 b(This)23
b(oper)n(-)2158 5309 y(ation)e(returns)f(a)i(string)f(whose)h(length)e
(cannot)h(be)g(kno)n(wn)2158 5408 y(to)f(the)g(client)g(in)h(adv)n
(ance.)1929 5657 y(5)p eop
%%Page: 6 6
6 5 bop 166 91 a Fl(As)24 b(luck)g(w)o(ould)f(ha)n(v)o(e)g(it,)i(the)e
Fe(GetSignature\(\))f Fl(op-)166 191 y(eration)27 b(is)j(the)e(\002rst)
h(time)f(we)h(ha)n(v)o(e)f(needed)e(to)j(de\002ne)f(a)166
291 y(commonly)d(used)i(operation)e(with)i(a)g(response)f(size)i(that)
166 390 y(is)21 b(not)f(kno)n(w)o(able)f(at)h(call)h(time.)100
579 y(T)-7 b(o)30 b(our)g(kno)n(wledge,)h(ER)m(OS)g(and)f(K)n(e)o(yK)n
(OS)g(are)g(the)h(only)0 679 y(current)f(IPC)i(systems)g(implementing)d
(truncation.)56 b(L4)31 b(does)0 779 y(not.)0 988 y Fo(3.4)99
b(Effect)27 b(of)d(T)n(imeouts)0 1128 y Fl(As)d(pre)n(viously)d
(discussed,)h(timeouts)h(impede)f(predictable)f(be-)0
1228 y(ha)n(vior)k(and)h(testability)-5 b(.)34 b(Personal)23
b(discussion)g(with)h(Y)-9 b(oon)22 b(Ho)0 1327 y(P)o(ark)h(re)o
(garding)e(ho)n(w)j(timeout)f(v)n(alues)g(were)h(actually)f(used)h(in)0
1427 y(L4-based)15 b(Sa)o(wMill)i(multiserv)o(er)e(system)i([10)o(])g
(concluded)d(that)0 1526 y(the)j(use)g(of)g(L4)g(timeouts)f(\(and)g
(timeouts)h(in)g(general\))f(can)g(be)h(di-)0 1626 y(vided)i(into)h
(four)f(cate)o(gories:)62 1797 y(1.)41 b(Do)20 b(not)f(w)o(ait)i(at)f
(all)g(\(corresponds)d(to)j(ER)m(OS)g(truncation\).)62
1913 y(2.)41 b(W)-7 b(ait)22 b(inde\002nitely)62 2029
y(3.)41 b(W)-7 b(ait)41 b(for)f(some)f(period)g(moti)n(v)n(ated)f(by)i
(an)g(e)o(xternally)166 2129 y(speci\002ed)17 b(duration)e(in)i(the)f
(real)h(w)o(orld.)23 b(F)o(or)17 b(e)o(xample,)f(if)h(a)166
2229 y(disk)22 b(dri)n(v)o(e)e(is)i(speci\002ed)g(to)f(ha)n(v)o(e)g(a)h
(maximum)e(seek)i(time)166 2328 y(of)j(12ms,)i(b)n(ut)e(no)g(seek)h
(completion)e(interrupt)g(has)i(been)166 2428 y(recei)n(v)o(ed)18
b(within)i(20ms,)f(something)f(is)j(probably)d(wrong.)62
2544 y(4.)41 b(All)20 b(other)e(v)n(alues.)24 b(In)19
b(principle)f(an)o(y)g(such)h(v)n(alue)f(must)h(be)166
2644 y(incorrect)e(unless)h(the)g(dynamic)e(range)h(of)g(possible)h(w)o
(ork-)166 2743 y(loads)i(can)g(be)g(speci\002ed)g(in)g(adv)n(ance.)0
2914 y(In)e(practice,)f(L4)h(services)g(do)g(not)f(use)h(timeouts)g(in)
g(the)g(last)h(cat-)0 3014 y(e)o(gory)-5 b(,)25 b(typically)f
(resorting)h(either)g(to)h(in\002nite)f(timeouts)h(or)f(to)0
3114 y(non-blocking)20 b(IPC)k(operations.)34 b(This)24
b(suggests)f(that)h(in)g(prac-)0 3213 y(tice)c(the)g(addition)f(of)h(a)
g(timeout)f(v)n(alue)h(is)g(an)g(inef)n(fecti)n(v)o(e)e(guard)0
3313 y(against)i(defecting)e(clients.)100 3414 y(Setting)34
b(aside)h(the)g(question)f(of)h(ef)n(fecti)n(v)o(eness,)h(timeouts)0
3514 y(embedded)13 b(in)j(IPC)g(operations)e(present)h(dif)n
(\002culties)g(in)g Fn(friendly)0 3613 y Fl(use:)54 b(the)o(y)34
b(preclude)f(testability)-5 b(,)38 b(and)c(the)o(y)g(do)g(not)h
(interact)0 3713 y(f)o(a)n(v)n(orably)26 b(with)h(deb)n(ugging)e
(\(because)h(the)h(recipient)f(may)h(be)0 3813 y(stopped\).)32
b(In)23 b(practice,)g(when)g(such)g(a)g(timeout)g(is)h(triggered)d(it)0
3912 y(is)h(usual)f(for)f(the)h(IPC)g(to)g(f)o(ail,)h(b)n(ut)e(the)h
(IPC)h(sender)e(is)i(nonethe-)0 4012 y(less)g(block)o(ed)d(for)h(the)h
(duration)e(of)h(the)h(timeout)f(when)g(it)h(could)0
4112 y(potentially)e(be)h(doing)f(useful)h(w)o(ork.)100
4213 y(When)15 b(IPC)i(timeouts)e(are)h(le)n(v)o(eraged)e(to)i(support)
f(client-side)0 4312 y(page)20 b(f)o(aults)g(during)e(IPC)j(\(as)g(in)f
(L4\),)g(the)g(timeout)f(mechanism)0 4412 y(can)24 b(be)g(e)o(xploited)
e(by)h(hostile)h(clients)h(to)f(implement)f(ef)n(\002cient)0
4512 y(denial)f(of)h(service)g(attacks)g(against)f(other)g(clients)i
(that)f(share)g(a)0 4611 y(common)c(serv)o(er)i(\(e.g.)27
b(a)22 b(windo)n(w)e(system\))h(with)g(the)g(attack)o(er)-5
b(.)0 4711 y(The)32 b(attack)g(proceeds)f(by)h(\002rst)h(implementing)d
(a)j(client-side)0 4811 y(page)19 b(f)o(ault)h(handler)e(that)i(simply)
f(ne)n(v)o(er)g(w)o(aits)i(for)e(a)h(page)f(f)o(ault)0
4910 y(noti\002cation.)64 b(W)m(ith)34 b(this)g(page)e(f)o(ault)i
(handler)e(in)i(place,)i(the)0 5010 y(client)26 b(sends)f(a)h(string)f
(containing)f(an)h(unde\002ned)f(page)g(to)i(the)0 5109
y(shared)h(serv)o(er)-5 b(.)48 b(The)27 b(recei)n(ving)f(serv)o(er)h
(thread)g(\(in)h(L4:)40 b(task\))0 5209 y(is)20 b(rendered)d
(inaccessable)i(until)g(the)h(timeout)e(e)o(xpires.)24
b(In)19 b(con-)0 5309 y(sequence,)26 b(well-beha)n(v)o(ed)e(clients)j
(cannot)e(in)m(v)n(ok)o(e)g(the)h(serv)o(er)-5 b(.)0
5408 y(Multithreading)19 b(does)j(not)f(circumv)o(ent)f(this)i(attack.)
29 b(It)22 b(simply)1992 91 y(requires)i(that)i(se)n(v)o(eral)f
(duplicates)g(of)g(the)h(attacking)f(client)h(be)1992
191 y(used.)d(All)16 b(of)g(these)g(duplicates)f(can)h(share)f(in)h
(common)e(a)j(single)1992 291 y(defecting)h(page)i(f)o(ault)g(handler)
-5 b(.)2091 390 y(L4)20 b(pro)o(vides)f(timeouts,)g(ER)m(OS)i(does)f
(not.)1992 630 y Fr(4)119 b(Case)29 b(Analysis)h(f)m(or)g(Suspicious)h
(IPC)1992 756 y Fl(In)22 b(seeking)h(a)g(solution)g(to)g(the)g(problem)
f(of)h(asymmetric)f(trust,)1992 855 y(we)e(w)o(ould)g(lik)o(e)g(to)g
(satisfy)h(three)f(objecti)n(v)o(es:)2054 1007 y(1.)41
b(W)-7 b(e)51 b(w)o(ould)e(lik)o(e)h(to)g(a)n(v)n(oid)f(introducing)f
(comple)o(xity)2158 1106 y(whene)n(v)o(er)32 b(possible.)67
b(Comple)o(x)33 b(strate)o(gies)h(used)g(by)g(a)2158
1206 y(serv)o(er)19 b(manifest)h(as)g(latenc)o(y)g(e)o(xperienced)d(by)
j(its)h(clients.)2054 1322 y(2.)41 b(When)25 b(a)g(client)h(defects,)g
(we)f(w)o(ould)g(lik)o(e)g(to)h(impose)f(the)2158 1422
y(cost)20 b(of)g(misbeha)n(vior)f(on)g(the)i(client.)2054
1538 y(3.)41 b(W)-7 b(e)23 b(must)f(a)n(v)n(oid)f(solutions)h(that)g
(con)m(v)o(ert)d(a)k(localized)e(de-)2158 1638 y(nial)f(of)g(service)g
(into)g(a)g(systemwide)g(denial)g(of)g(service.)1992
1835 y Fo(4.1)99 b(Sour)n(ces)26 b(of)f(V)-9 b(ulnerability)1992
1972 y Fl(Before)37 b(looking)f(for)i(a)g(general)f(solution)g(to)h
(the)g(defecting)1992 2071 y(client,)30 b(it)g(is)g(useful)e(to)h
(\002rst)h(understand)d(the)h(cases)i(in)f(which)1992
2171 y(the)21 b(problem)f(is)i(actually)f(a)h(threat.)28
b(This)22 b(is)g(useful)f(because)g(of)1992 2270 y(an)f(\223escape)h
(hatch\224)f(in)h(the)g(requirements)e(on)h(the)h(IPC)h(subsys-)1992
2370 y(tem:)29 b(we)23 b(need)f(not)g(guarantee)f(service)h(to)h
(attack)o(ers.)31 b(If)23 b(it)g(can)1992 2470 y(be)29
b(determined)e(that)j(a)g(recei)n(v)o(er)e(is)i(defecting,)g(the)g(IPC)
g(sub-)1992 2569 y(system)21 b(can)g(be)h(absolv)o(ed)d(of)i(its)i
(responsibility)d(to)h(deli)n(v)o(er)g(the)1992 2669
y(message.)2091 2769 y(The)28 b(potential)f(sources)g(of)h(blockage)e
(in)i(the)f(IPC)i(process)1992 2868 y(lie)22 b(in)f(the)h(in)m(v)n
(ocation)e(type)h(\(di)n(visible)f(or)i(indi)n(visible\),)e(the)i(in-)
1992 2968 y(v)n(ok)o(ee)f(state,)h(the)g(in)m(v)n(ok)o(er')-5
b(s)20 b(transmitted)h(string)g(\(page)g(f)o(aults\),)1992
3067 y(and)e(the)h(in)m(v)n(ok)o(ee')-5 b(s)20 b(recei)n(v)o(ed)e
(string)i(\(page)f(f)o(aults\).)1992 3285 y Fh(4.1.1)81
b(In)m(v)o(ok)o(er)20 b(Thr)o(ead,)g(String)g(V)-8 b(ulnerabilities)
1992 3441 y Fl(As)18 b(long)e(as)i(IPC)g(in)m(v)n(ocations)d(are)j
(speci\002ed)f(as)h(indi)n(visible,)e(we)1992 3540 y(can)h(rely)h(on)g
(the)g(f)o(act)g(that)g(the)g(in)m(v)n(ok)o(er)f(cannot)g(cause)h(the)g
(in)m(v)n(o-)1992 3640 y(cation)25 b(to)h(block)f(without)h
(completing.)41 b(T)-7 b(o)26 b(pre)n(v)o(ent)e(in)m(v)n(ok)o(er)n(-)
1992 3740 y(side)30 b(page)f(f)o(aults,)j(the)e(IPC)g(implementation)e
(can)h(beha)n(v)o(e)g(as)1992 3839 y(though)f(a)i(\223dry)f(run\224)g
(is)h(performed)e(on)h(the)h(sender)f(side)h(be-)1992
3939 y(fore)15 b(the)i(real)f(in)m(v)n(ocation,)f(ef)n(fecti)n(v)o(ely)
g(causing)h(all)h(sender)n(-side)1992 4039 y(page)25
b(f)o(aults)h(to)h(occur)e(prior)g(to)h(the)g(in)m(v)n(ocation)e(and)i
(ensuring)1992 4138 y(that)35 b(the)g(sender)n(-side)f(string)g(is)i
(ready)e(prior)h(to)g(in)m(v)n(ocation.)1992 4238 y(F)o(ollo)n(wing)24
b(a)i(successful)f(dry)g(run,)h(we)g(may)f(assume)h(that)f(e)o(x-)1992
4337 y(ceptions)18 b(in)i(the)g(send)f(string)h(re)o(gion)e(constitute)
h(defection)f(and)1992 4437 y(abort)23 b(the)i(in)m(v)n(ocation.)37
b(This)25 b(is)h(ho)n(w)e(the)h(ER)m(OS)g(IPC)h(mecha-)1992
4537 y(nism)20 b(is)h(speci\002ed.)1992 4755 y Fh(4.1.2)81
b(In)m(v)o(ok)o(ee)20 b(in)h(Wr)o(ong)e(State)1992 4910
y Fl(The)f(ne)o(xt)f(concern)g(is)j(to)e(consider)g(whether)f(the)i
(recipient)e(may)1992 5010 y(be)25 b(in)g(the)g(wrong)f(state)i(to)f
(accept)g(the)g(IPC)h(in)m(v)n(ocation)e(at)h(all.)1992
5109 y(W)-7 b(e)23 b(must)g(here)f(consider)f(tw)o(o)i(kinds)f(of)g(in)
m(v)n(ok)o(ee)g(states:)31 b(open)1992 5209 y(w)o(aits)c(and)e(closed)h
(w)o(aits.)44 b(The)26 b(blocking)f(beha)n(vior)f(e)o(xpected)1992
5309 y(by)g(an)h(in)m(v)n(ok)o(er)e(depends)h(on)h(the)g(e)o(xpected)e
(state)j(of)f(the)g(in)m(v)n(o-)1992 5408 y(k)o(ee.)1929
5657 y(6)p eop
%%Page: 7 7
7 6 bop 100 91 a Fl(When)36 b(an)h(in)m(v)n(ok)o(er)e(process)h
Fg(P)1075 103 y Fd(0)1150 91 y Fl(performs)f(an)i(IPC)h(to)f(a)0
191 y(serv)o(er)27 b(process)g Fg(S)33 b Fl(that)28 b(is)g(in)g(an)f
(open)g(w)o(ait,)j(there)d(is)i(an)e(im-)0 291 y(plicit)21
b(race)g(with)g(all)g(other)g(processes)f(that)h(might)f(be)h(in)m(v)n
(oking)0 390 y Fg(S)5 b Fl(.)24 b(It)17 b(is)h(possible)f(that)g(some)f
(other)g(process)h Fg(P)1374 402 y Fd(1)1429 390 y Fl(beats)g
Fg(P)1670 402 y Fd(0)1725 390 y Fl(to)g(the)0 490 y(in)m(v)n(ocation)g
(and)h Fg(P)557 502 y Fd(0)613 490 y Fl(may)g(consequently)f(block)g
(for)h(a)h(period)e(of)0 589 y(time)27 b(controlled)d(by)j
Fg(S)5 b Fl(.)44 b(Therefore,)25 b(in)i(an)o(y)f(such)g(in)m(v)n
(ocation)0 689 y(the)21 b(in)m(v)n(ok)o(er)f(is)i(implicitly)e
(declaring)g(that)h(the)o(y)g(permit)f(the)h(in-)0 789
y(v)n(ok)o(ee)f(to)g(inde\002nitely)f(block)g(the)h(in)m(v)n(ok)o(er)-5
b(.)100 893 y(In)15 b(a)h(closed)g(w)o(ait)g(matters)g(are)g(quite)f
(dif)n(ferent.)22 b(The)16 b(in)m(v)n(ok)o(er)0 993 y(e)o(xpects)25
b(that)h(the)f(in)m(v)n(ok)o(ee)f(is)j(w)o(aiting)e(for)g(a)h
(response.)40 b(If)26 b(for)0 1092 y(some)g(reason)g(the)h(in)m(v)n(ok)
o(ee)e(is)i Fn(not)h Fl(w)o(aiting)e(in)h(a)f(closed)h(w)o(ait,)0
1192 y(then)19 b(the)h(in)m(v)n(ok)o(ee)e(has)h(defected.)24
b(In)19 b(practice,)g(the)g(closed)g(w)o(ait)0 1291 y(arises)e(when)e
(a)i(serv)o(er)e(is)i(responding)c(to)k(a)f(pre)n(vious)f(client)h
(call.)0 1391 y(This)i(is)h(the)f(case)g(in)g(which)f(prompt)f
(completion)g(is)j(required)d(to)0 1491 y(pre)n(v)o(ent)i(denial)i(of)g
(service)g(attacks)g(against)g(the)g(serv)o(er)-5 b(.)100
1595 y(In)26 b(the)h(L4)g(IPC)g(system,)i(there)d(is)i(no)e(direct)h
(coupling)d(be-)0 1694 y(tween)16 b(the)h(in)m(v)n(ok)o(ee)d(state)k
(and)d(the)i(in)m(v)n(ok)o(er)d(in)m(v)n(ocation.)22
b(Where)0 1794 y(the)29 b(processes)g(in)m(v)n(olv)o(ed)e(kno)n(w)h
(that)i(procedure-call)c(seman-)0 1894 y(tics)19 b(is)h(e)o(xpected)c
(the)j(client)f(can)g(use)h(a)g(\223w)o(ait)g(fore)n(v)o(er\224)d
(timeout)0 1993 y(and)27 b(w)o(aits)h(in)f(a)g(closed)g(w)o(ait.)46
b(The)27 b(serv)o(er)f(responds)g(using)h(a)0 2093 y(\223do)20
b(not)f(w)o(ait\224)i(timeout.)100 2197 y(In)j(the)h(ER)m(OS)g(IPC)h
(system,)g(a)f Fm(start)h(capability)e Fl(is)h(a)h(capa-)0
2297 y(bility)f(whose)g(in)m(v)n(ocation)f(will)i(block)e(unless)h(the)
h(recipient)e(is)0 2396 y(in)31 b(the)f(a)n(v)n(ailable)g(\(open)f(w)o
(ait\))i(state.)56 b(A)31 b Fm(resume)g(capability)0
2496 y Fl(must)e(be)f(used)h(to)f(in)m(v)n(ok)o(e)g(a)h(process)f(in)h
(the)f(w)o(aiting)h(\(closed)0 2596 y(w)o(ait\))e(state.)44
b(An)o(y)26 b(operation)e(that)j(causes)f(an)h(ER)m(OS)g(process)0
2695 y(to)j(lea)n(v)o(e)g(the)f(w)o(aiting)h(state)g(causes)h(all)f
(outstanding)e(resume)0 2795 y(capabilities)e(to)g(be)g(ef)n
(\002ciently)f(rescinded,)h(guaranteeing)d(that)0 2895
y(client-side)28 b(deb)n(uggers)f(cannot)g(be)i(e)o(xploited)d(as)k(a)f
(means)f(to)0 2994 y(attack)21 b(serv)o(ers.)28 b(Resume)22
b(capabilities)f(are)g(consumed)f(as)i(the)o(y)0 3094
y(are)e(used.)25 b(This)20 b(pre)n(v)o(ents)e(a)j(serv)o(er)e(that)h
(is)h(later)g(compromised)0 3193 y(from)e(performing)e(denial)j(of)g
(service)g(attacks)g(on)g(past)g(clients.)0 3440 y Fh(4.1.3)81
b(Recei)o(v)o(e)20 b(String)g(P)o(age)g(F)n(aults,)g(Lar)o(ge)g
(Strings)0 3604 y Fl(When)32 b(the)h(in)m(v)n(ocation)d(protocol)h
(declares)h(that)h(the)f(in)m(v)n(ok)o(ee)0 3704 y(may)27
b(le)o(gally)g(block)g(the)g(in)m(v)n(ok)o(er)m(,)h(as)g(in)g(\223w)o
(ait)g(fore)n(v)o(er\224)e(\(L4\))0 3803 y(or)e(start)h(capability)e
(\(ER)m(OS\))h(in)m(v)n(ocations,)f(we)i(need)e(not)h(con-)0
3903 y(sider)g Fn(why)h Fl(blocking)e(occurs.)36 b(By)25
b(agreeing)e(to)i(block,)f(the)g(in-)0 4002 y(v)n(ok)o(er)15
b(is)i(implicitly)f(saying)g(that)g(it)h(trusts)f(the)g(recei)n(v)o(er)
f(to)h(mak)o(e)0 4102 y(decisions)24 b(about)f(the)h(disposition)g(of)g
(the)g(in)m(v)n(ok)o(er')-5 b(s)23 b(thread)g(of)0 4202
y(control.)56 b(As)32 b(long)f(as)g(it)h(can)f(tell)h(that)f(this)h(is)
g(the)f(case,)j(the)0 4301 y(IPC)f(subsystem)e(is)i(free)e(to)h(run)f
(an)h(in)m(v)n(ok)o(ee-speci\002ed)d(page)0 4401 y(f)o(ault)22
b(handler)-5 b(.)29 b(If)22 b(the)g(in)m(v)n(ok)o(er)e(has)j
(speci\002ed)e(that)h(the)g(in)m(v)n(oca-)0 4501 y(tion)e(must)h(be)g
(prompt,)e(as)j(in)e(the)h(do)g(not)f(w)o(ait)h(\(L4\))f(or)h(resume)0
4600 y(k)o(e)o(y)31 b(\(ER)m(OS\))h(in)m(v)n(ocations,)h(in)m(v)n(ok)o
(ee)e(page)g(f)o(aults)h(cannot)f(be)0 4700 y(serviced)22
b(unless)h(a)h(guarantee)d(of)i(prompt)e(completion)g(can)i(be)0
4799 y(achie)n(v)o(ed.)315 4769 y Fk(3)100 4904 y Fl(Unless)k(care)f
(is)h(tak)o(en)f(in)h(the)f(design,)h(a)g(parallel)f(problem)0
5003 y(can)h(arise)g(if)g(long)f(strings)h(are)f(to)h(be)g
(transferred.)43 b(Real-time)p 0 5093 764 4 v 0 5148
a Fj(3)66 5172 y Ft(I)22 b(ha)o(v)o(e)g(chosen)g(to)g(gloss)g(o)o(v)o
(er)g(the)g(distinction)j(in)d(L4)e(between)k(page)e(f)o(ault)66
5251 y(servicing)d(timeouts)e(and)g(in)m(v)o(ok)o(ee)i(readiness)f
(timeouts;)g(the)f(essential)i(point)66 5329 y(is)c(that)g(the)g(in)m
(v)o(ok)o(er)i(has)d(said)h(that)h(the)o(y)f(will)h(not)e(agree)i(to)f
(block)g(for)g(in)m(v)o(ok)o(ee)66 5408 y(pagers.)1992
91 y Fl(schedulers)h(rely)i(on)f(the)h(f)o(act)g(that)g(clock-dri)n(v)o
(en)c(and)j(interrupt-)1992 191 y(dri)n(v)o(en)23 b(preemption)f(are)j
(recognized)e(quickly)g(by)i(the)g(proces-)1992 291 y(sor)-5
b(.)24 b(As)17 b(a)g(result,)g(the)g(internal)e(implementation)g(of)h
(an)g(IPC)h(that)1992 390 y(transmits)22 b(long)h(strings)g(must)g
(break)e(the)i(operation)e(into)i(mul-)1992 490 y(tiple)g(internal)g
(units)g(of)g(operation,)f(each)h(ha)n(ving)f(a)i(maximum)1992
589 y(duration)18 b(chosen)h(to)i(a)n(v)n(oid)f(interfering)e(with)i
(the)g(scheduler)-5 b(.)2091 689 y(Gi)n(v)o(en)40 b(the)g(need)g(for)g
(internal)g(units)h(of)f(operation,)k(the)1992 789 y(IPC)30
b(designer)e(may)h(be)g(tempted)f(to)i(mak)o(e)f(the)g(e)o(xternal)f
(\(i.e.)1992 888 y(application-visible\))21 b Fn(speci\002cation)i
Fl(of)h(the)g(IPC)i(primiti)n(v)o(e)d(di-)1992 988 y(visible)g(in)g
(some)g(form.)32 b(There)23 b(are)g(tw)o(o)g(security)g(design)f(haz-)
1992 1088 y(ards)e(here:)2054 1253 y(1.)41 b(The)15 b(serv)o(er)g(must)
h(not)g(be)g(block)o(ed)e(by)i(an)g(untrusted)f(client)2158
1353 y(when)k(engaging)f(in)i(an)g(e)o(xtended)f(transfer)m(,)f(and)
2054 1519 y(2.)41 b(The)23 b(serv)o(er)h(must)g(not)g(be)g(required)f
(to)h(inde\002nitely)f(hold)2158 1618 y(state)31 b(in)f(hopes)g(that)g
(an)g(IPC)i(might)d(later)i(be)f(resumed,)2158 1718 y(which)18
b(precludes)g(servicing)g Fn(other)i Fl(requests)f(while)g(there)2158
1818 y(is)i(an)f(incomplete)f(di)n(visible)g(IPC)i(outstanding.)1992
1983 y(T)-7 b(o)23 b(a)n(v)n(oid)g(these)h(hazards,)f(the)g
(scatter/gather)f(and)g(long)h(string)1992 2083 y(enhancements)33
b(to)j(the)g(ER)m(OS)g(IPC)g(speci\002cation)f(allo)n(w)h(an)1992
2183 y(IPC)i(to)g(be)g(cleanly)f(aborted,)k(b)n(ut)d(do)f(not)h(permit)
f(it)i(to)f(be)1992 2282 y(\223paused\224)19 b(prior)g(to)h
(completion.)1992 2483 y Fo(4.2)99 b(A)n(pplication)24
b(Lay)o(er)i(Implications)1992 2620 y Fl(W)m(ith)31 b(the)h(sources)f
(of)g(vulnerability)e(characterized,)j(we)g(can)1992
2719 y(\002nally)16 b(e)o(xamine)f(the)h(impact)g(on)g(the)h
(application-le)n(v)o(el)c(remote)1992 2819 y(procedure)18
b(call)j(protocol)f(in)h(cases)g(where)g(in)m(v)n(ok)o(ee)e(page)i(f)o
(ault)1992 2918 y(handlers)e(cannot)g(be)h(safely)g(e)o(x)o(ecuted.)
2091 3018 y(Pro)o(vided)i(that)i(IPC)g(operations)f(are)g(speci\002ed)h
(as)g(indi)n(visi-)1992 3118 y(ble,)18 b(the)g(dif)n(\002cult)f(case)h
(arises)h(only)e(when)g Fn(all)i Fl(of)e(the)h(follo)n(wing)1992
3217 y(conditions)g(apply:)2075 3400 y Fi(\017)41 b Fl(The)19
b(in)m(v)n(ocation)g(type)g(precludes)g(blocking,)2075
3516 y Fi(\017)41 b Fl(The)19 b(payload)e(size)j(cannot)e(be)i(kno)n
(wn)d(in)j(adv)n(ance)e(by)h(the)2158 3615 y(recei)n(v)o(er)m(,)f
Fn(and)2075 3732 y Fi(\017)41 b Fl(The)23 b(side-ef)n(fects)g(or)h
(computational)e(cost)i(of)g(the)g(opera-)2158 3831 y(tion)h(preclude)f
(reco)o(v)o(ery)g(by)h(deli)n(v)o(ering)f(a)i(truncated)f(re-)2158
3931 y(sponse)18 b(to)i(the)f(client,)h(adjusting)e(the)h(client)h
(recei)n(v)o(e)e(area,)2158 4031 y(and)h(replaying)g(the)h(in)m(v)n
(ocation.)2091 4213 y(Our)j(e)o(xperience)d(with)j(ER)m(OS)h(has)f
(been)f(that)h(the)g(v)n(ast)g(ma-)1992 4312 y(jority)29
b(of)h(interprocess)f(in)m(v)n(ocations)f(ha)n(v)o(e)i(a)g(statically)h
(spec-)1992 4412 y(i\002ed)37 b(upper)g(bound)e(on)j(their)f(payload)f
(in)i(both)f(directions,)1992 4512 y(e)n(v)o(en)27 b(when)i(data)g
(motion)e(is)j(in)m(v)n(olv)o(ed.)49 b(Read)29 b(and)g(write)g(re-)1992
4611 y(quests,)24 b(for)f(e)o(xample,)f(typically)h(specify)g(an)g
(upper)f(bound)g(on)1992 4711 y(the)j(b)n(uf)n(fer)g(length.)41
b(Whene)n(v)o(er)24 b(such)h(a)i(bound)c(can)j(be)g(estab-)1992
4811 y(lished,)33 b(we)e(can)f(reasonably)f(require)g(that)i(well-beha)
n(v)o(ed)e(re-)1992 4910 y(cipients)22 b(will)h(pre-v)n(alidate)e
(their)h(recei)n(v)o(e)g(b)n(uf)n(fer)f(areas.)33 b(In)22
b(all)1992 5010 y(such)29 b(cases,)k(the)d(sender)f(can)g(rob)n(ustly)g
(use)h(a)g(non-blocking,)1992 5109 y(truncating)22 b(IPC)j(operation.)
36 b(Most)25 b(replies)f(carry)g(no)g(string)g(at)1992
5209 y(all.)33 b(F)o(or)22 b(those)h(that)g(do,)g(the)g(string)f(is)i
(generally)d(smaller)i(than)1992 5309 y(one)i(page,)i(so)f(the)g(recei)
n(v)o(e)f(area)h(v)n(alidation)f(requirement)f(im-)1992
5408 y(poses)c(no)g(signi\002cant)f(performance)e(cost.)1929
5657 y(7)p eop
%%Page: 8 8
8 7 bop 100 91 a Fl(If)23 b(the)g(in)m(v)n(ok)o(ee)e(of)i(a)g
(non-blocking)d(IPC)k(operation)d(kno)n(ws)0 191 y(the)30
b(length)f(of)h(the)g(e)o(xpected)e(message)i(and)f(f)o(ails)i(to)f
(pro)o(vide)0 291 y(adequately)38 b(v)n(alidated)h(b)n(uf)n(fer)g
(space)h(then)g(it)g(has)h(not)e(cor)n(-)0 390 y(rectly)16
b(e)o(x)o(ecuted)e(the)j(higher)n(-le)n(v)o(el)d(RPC)k(protocol.)k(In)
16 b(this)h(case)0 490 y(we)29 b(can)g(presume)f(that)h(it)h(has)g
(defected.)50 b(The)29 b(non-blocking)0 589 y(requirement)37
b(is)j(therefore)d(a)j(concern)d(only)i(when)f(a)i(well-)0
689 y(beha)n(v)o(ed)22 b(recei)n(v)o(er)h(is)i Fn(unable)d
Fl(to)i(bound)f(the)h(length)f(of)g(the)h(re-)0 789 y(ply)-5
b(.)100 888 y(Man)o(y)20 b(of)h(these)g(unboundable)c(cases)22
b(\226)f(in)g(particular)f(those)0 988 y(that)30 b(in)m(v)n(olv)o(e)f
(the)h(return)g(of)g(strings)g(\226)g(are)h(replayable.)53
b(One)0 1088 y(e)o(xample)20 b(is)i(the)f(pre)n(viously)e(described)h
(\223get)h(signature\224)f(oper)n(-)0 1187 y(ation:)150
1287 y Fh(r)o(eplayable)150 1386 y Fe(vector<char,)48
b(*>)h(GetSignature\(IF\);)100 1486 y Fl(In)21 b(this)i(in)m(v)n
(ocation,)d(the)i(serv)o(er)f(can)h(respond)e(using)i(a)g(non-)0
1586 y(blocking)36 b(IPC.)i(If)f(the)h(response)e(string)h(e)o(xceeds)g
(the)h(v)n(alid)0 1685 y(b)n(uf)n(fer)26 b(length)g(of)h(the)g
(recipient,)h(the)f(reply)g(is)h(truncated.)44 b(As)0
1785 y(long)15 b(as)i(the)f(IPC)h(primiti)n(v)o(e)d(reports)i(to)g(the)
g(stub)g(layer)f(the)h(num-)0 1885 y(ber)28 b(of)h(bytes)f(that)h(were)
g(sent)g(\(as)g(opposed)e(to)i(recei)n(v)o(ed\))e(the)0
1984 y(stub)k(can)g(transparently)f(increase)h(the)g(recei)n(v)o(e)f
(string)h(b)n(uf)n(fer)0 2084 y(size)21 b(and)e(retry)h(the)g(in)m(v)n
(ocation.)0 2283 y Fo(4.3)99 b(The)26 b(Dif\002cult)g(Case)0
2420 y Fl(W)-7 b(e)25 b(ha)n(v)o(e)f(no)n(w)f(reduced)g(the)h(dif)n
(\002cult)g(case)g(\226)h(non-replayable)0 2519 y(in)m(v)n(ocations)19
b(with)i(client-unkno)n(wn)c(payload)i(\226)i(to)f(a)h(relati)n(v)o
(ely)0 2619 y(rare)16 b(set)h(of)e(situations:)24 b(those)16
b(in)g(which)f(a)i(side)f(ef)n(fect)g(occurs)f(or)0 2718
y(the)26 b(cost)f(of)h(performing)c(a)k(\223dry)f(run\224)g(in)m(v)n
(ocation)e(\(replay\))h(is)0 2818 y(prohibiti)n(v)o(e.)e(In)d(L4,)g
(the)h(solution)e(at)i(this)g(point)e(is)j(a)f(page)e(f)o(ault)0
2918 y(IPC)g(timeout.)23 b(Because)18 b(ER)m(OS)f(is)i(a)e
(capability-based)e(system,)0 3017 y(it)21 b(of)n(fers)e(the)h
(possibility)g(of)g(a)h(more)e(\003e)o(xible)h(solution.)100
3117 y(If)i(a)h(lar)o(ge)f(message)h(is)g(to)g(be)g(transferred)e(in)i
(a)g(single)g(logi-)0 3217 y(cal)h(operation,)e(the)h(client)g(cannot)f
(reliably)h(accept)g(it,)h(and)f(the)0 3316 y(serv)o(er)17
b(must)i(not)f(block,)f(then)h Fn(somebody)f Fl(must)i(pro)o(vide)d
(mem-)0 3416 y(ory)25 b(to)i(hold)e(it.)44 b(In)26 b(a)g(typical)g(IPC)
h(design,)g(either)f(the)g(sender)0 3515 y(holds)20 b(it)h(in)f(sender)
g(memory)f(and)g(uses)i(some)g(timeout)e(mecha-)0 3615
y(nism)h(to)g(decide)f(when)h(to)g(abort)f(the)h(in)m(v)n(ocation,)e
(or)i(the)g(k)o(ernel)0 3715 y(must)27 b(pro)o(vide)e(b)n(uf)n(fers.)44
b(Based)27 b(on)f(the)h(IPC)h(speci\002cation,)f(it)0
3814 y(initially)22 b(appears)g(that)g(ER)m(OS)h(must)f(either)g
(truncate)f(these)h(in-)0 3914 y(v)n(ocations)30 b(or)h(incorporate)e
(some)i(form)g(of)g(timeout)f(into)h(the)0 4014 y(capability)22
b(in)m(v)n(ocation)f(mechanism.)31 b(This)23 b(w)o(as)h(the)e(source)g
(of)0 4113 y(the)e(mischaracterization)d(in)j(F)o(ord)f
Fn(et)h(al.)25 b Fl([7)o(].)g(The)19 b(ne)o(xt)g(gener)n(-)0
4213 y(ation)f(ER)m(OS)h(system)f(pro)o(vides)f(the)h(underpinnings)d
(for)j(a)h(third)0 4312 y(solution.)100 4412 y(First,)k(we)f(must)g
(admit)f(that)h(the)g(problem)f(of)g(serv)o(er)g(block-)0
4512 y(ing)g(has)g(been)g(slightly)g(mischaracterized.)26
b(W)-7 b(e)23 b(ha)n(v)o(e)d(said)i(that)0 4611 y(the)34
b(serv)o(er)e(must)i(not)f(block,)j(b)n(ut)e(this)g(is)h(o)o(v)o(erly)c
(constrain-)0 4711 y(ing.)25 b(A)c(more)f(precise)g(statement)g(is)h
(that)g(the)f(serv)o(er)g(cannot)f(be)0 4811 y(block)o(ed)25
b Fn(by)h(an)f(untrusted)g(party)p Fl(.)42 b(In)26 b(particular)m(,)g
(if)g(a)h(trusted)0 4910 y(b)n(uf)n(fering)16 b(agent)i(were)h(a)n(v)n
(ailable,)f(the)h(serv)o(er)e(could)h(safely)g(en-)0
5010 y(capsulate)f(the)g(message)g(in)g(a)h(b)n(uf)n(fer)e(for)g(later)
i(consumption)c(by)0 5109 y(the)20 b(client.)100 5209
y(The)25 b(problem)g(with)h(b)n(uf)n(fering)e(in)j(general)e(is)i(that)
f(\(a\))g(it)h(is)0 5309 y(e)o(xpensi)n(v)o(e,)20 b(and)i(\(b\))g(the)g
(wrong)f(party)g(pays)h(for)f(the)h(storage)g(\226)0
5408 y(usually)f(either)f(the)h(k)o(ernel)g(or)g(the)g(sender)-5
b(.)27 b(The)21 b(\002rst)h(is)g(merely)1992 91 y(a)g(nuisance.)29
b(The)21 b(second)h(is)g(a)h(a)f(potential)f(cause)h(of)f(denial)h(of)
1992 191 y(service.)k(In)21 b(ER)m(OS,)g(it)g(is)h(possible)f(to)g
(create)f(a)h(b)n(uf)n(fer)f(that)h(can)1992 291 y(be)g
Fn(trusted)j Fl(by)c(a)i(serv)o(er)f(b)n(ut)g Fn(paid)g(for)i
Fl(by)e(the)g(client.)29 b(W)-7 b(e)22 b(refer)1992 390
y(to)h(this)h(object)f(as)h(the)f Fm(trusted)i(b)n(uf)o(f)o(er)e
(object)g Fl(\(TBO\).)g(Ideally)-5 b(,)1992 490 y(the)29
b(use)h(of)g(a)g(trusted)g(b)n(uf)n(fer)e(object)h(w)o(ould)g(proceed)g
(as)h(fol-)1992 589 y(lo)n(ws:)2054 783 y(1.)41 b(When)19
b(CapIDL)h(\(the)g(ER)m(OS)g(IDL)g(compiler\))f(is)i(ask)o(ed)e(to)2158
882 y(generate)h(an)i(in)m(v)n(ocation)e(stub)i(for)f(a)h
(non-replayable)c(op-)2158 982 y(eration)e(that)i(has)f(an)h
(unboundable)c(reply)i(string,)i(it)g(modi-)2158 1081
y(\002es)h(the)g(in)m(v)n(ocation)f(signature)f(to)j(use)f(a)g(trusted)
g(interme-)2158 1181 y(diary:)39 b(the)28 b(trusted)g(b)n(uf)n(fer)e
(object.)48 b(The)28 b(client)g(in)m(v)n(ok)o(es)2158
1281 y(the)d(TBO,)h(which)f(in)m(v)n(ok)o(es)f(the)i(serv)o(er)f(on)g
(behalf)f(of)i(the)2158 1380 y(client.)2054 1497 y(2.)41
b(On)19 b(receipt,)f(the)h(serv)o(er)g(v)o(eri\002es)f(using)h(means)g
(described)2158 1596 y(belo)n(w)27 b(that)i(the)f(trusted)g(b)n(uf)n
(fer)f(object)g(is)j(authentic.)48 b(If)2158 1696 y(this)23
b(v)o(eri\002cation)f(succeeds,)h(the)h(serv)o(er)e(kno)n(ws)h(that)g
(this)2158 1795 y(object)k(really)g(e)o(x)o(ecutes)g(the)h(trusted)g(b)
n(uf)n(fer)e(object)i(pro-)2158 1895 y(gram.)g(As)23
b(a)f(consequence,)d(it)k(kno)n(ws)e(that)h(the)f(TBO)i(can)2158
1995 y(be)k(counted)f(on)i(not)f(to)h(defect.)47 b(Further)m(,)28
b(it)g(kno)n(ws)f(that)2158 2094 y(an)o(y)32 b(b)n(uf)n(fer)g(storage)g
(space)i(used)f(by)f(the)i(TBO)f(is)i(ulti-)2158 2194
y(mately)19 b(paid)h(for)g(by)f(the)i(client)f(program.)2054
2310 y(3.)41 b(The)26 b(serv)o(er)g(transmits)g(its)i(response)d
(string)i(to)f(the)h(TBO)2158 2410 y(using)f(the)h(\223e)o(xtended)d
(mutual)i(e)o(xclusion\224)g(pro)o(vided)e(by)2158 2509
y(the)h(ER)m(OS)g(IPC)h(primiti)n(v)o(es.)38 b(This)25
b(has)g(one)f(of)h(tw)o(o)g(out-)2158 2609 y(comes:)2207
2755 y(\(a\))40 b(The)20 b(TBO)h(accepts)f(the)g(entire)g(string,)g(or)
2202 2872 y(\(b\))40 b(The)20 b(TBO)h(runs)f(out)f(of)h(space)g(and)g
(reports)f(this.)2054 3018 y(4.)41 b(On)15 b(completion,)f(the)h(TBO)h
(returns)e(to)i(the)f(client,)h(passing)2158 3118 y(the)k(string)g
(supplied)f(by)h(the)g(serv)o(er)-5 b(.)2091 3311 y(Note)22
b(that)g(a)g(client)g(can)g(reuse)g(its)h(TBO)f(object)g(repeatedly)-5
b(.)1992 3411 y(Once)24 b(created,)g(the)g(per)n(-in)m(v)n(ocation)e(o)
o(v)o(erhead)f(of)j(the)h(TBO)g(is)1992 3510 y(minimal.)2091
3612 y(A)c(protocol)e(optimization)g(is)j(possible)e(to)h(a)n(v)n(oid)f
(recop)o(ying)1992 3712 y(the)d(string)h(from)f(the)h(TBO)g(to)g(the)g
(client.)24 b(Instead)17 b(of)h(accepting)1992 3812 y(the)g(string)g
(that)h(the)f(TBO)h(attempts)f(to)h(return)e(to)i(the)f(client,)h(the)
1992 3911 y(client)25 b(may)f(elect)i(to)f(accept)g(zero)f(bytes)h(w)o
(orth)g(of)f(data.)40 b(F)o(ol-)1992 4011 y(lo)n(wing)24
b(completion)g(of)h(the)g(TBO')-5 b(s)26 b(reply)-5 b(,)26
b(the)f(client)h(can)f(di-)1992 4111 y(rectly)15 b(map)h(the)h(TBO')-5
b(s)17 b(address)f(space)g(into)g(client)g(memory)-5
b(.)22 b(If)1992 4210 y(desired,)h(the)h(TBO)g(space)g(can)g(be)f
Fn(permanently)g Fl(mapped)f(into)1992 4310 y(client)16
b(memory)e(at)j(TBO)g(creation)e(time,)i(eliminating)e(the)h(o)o(v)o
(er)n(-)1992 4409 y(head)j(of)h(call-time)g(mapping)e(manipulations.)
2091 4512 y(During)h(an)g(early)h(re)n(vie)n(w)f(of)g(this)h(design,)f
(Mark)g(Miller)h(ob-)1992 4611 y(serv)o(ed)14 b(that)j(the)e(same)i
(memory)d(mapping)g(optimization)g(might)1992 4711 y(be)31
b(feasible)h(on)f(the)h Fn(server)j Fl(side)d(of)g(the)g(transaction,)h
(yield-)1992 4811 y(ing)23 b(a)i(zero-cop)o(y)d(implementation)g(for)h
(long)h(string)f(transfers.)1992 4910 y(The)e(problem)e(with)j(this)g
(lies)g(in)f(the)h(f)o(act)f(that)h(the)f(serv)o(er)g(must)1992
5010 y(be)e(prepared)e(to)j(reco)o(v)o(er)d(from)h(unsatis\002ed)i
(page)e(f)o(aults)i(within)1992 5109 y(this)g(mapping)e(re)o(gion)h
(when)g(client)h(space)g(is)h(e)o(xhausted.)j(Ask-)1992
5209 y(ing)g(the)g(TBO)i(ho)n(w)e(much)f(space)i(is)g(a)n(v)n(ailable)g
(does)f(not)g(help,)1992 5309 y(because)18 b(the)g(client)h(has)g(the)g
(authority)e(to)i(re)n(v)n(ok)o(e)e(this)j(space)e(in)1992
5408 y(mid-transfer)-5 b(.)30 b(Our)22 b(sense)h(at)g(this)g(point)e
(is)j(that)e(the)h(ef)n(\002cienc)o(y)1929 5657 y(8)p
eop
%%Page: 9 9
9 8 bop 0 91 a Fl(of)18 b(normal)f(TBO)i(in)m(v)n(ocation)e(is)i(high)f
(enough,)e(and)i(reco)o(v)o(ering)0 191 y(from)28 b(these)h(f)o(aults)g
(is)h(comple)o(x)e(enough,)h(that)g(this)g(approach)0
291 y(will)21 b(not)f(usually)f(pro)o(v)o(e)g(to)h(be)g(w)o(orthwhile.)
100 390 y(By)g(introducing)e(the)i(trusted)g(b)n(uf)n(fer)f(object)g
(into)h(the)h(proto-)0 490 y(col,)26 b(the)g(entire)f(b)n(urden)e(of)i
(resource)f(allocation)h(is)h(placed)e(on)0 589 y(the)c(client)h(in)f
(such)g(a)h(w)o(ay)f(that)h(the)f(serv)o(er)g(is)h(safe)f(from)g
(denial)0 689 y(of)k(resource)f(and)h(denial)g(of)g(service.)37
b(In)24 b(particular)m(,)f(the)h(TBO)0 789 y(is)19 b(transmitted)e
(using)g(capability)g(ar)o(guments)f(to)i(the)g(IPC)h(prim-)0
888 y(iti)n(v)o(e,)f(and)g(these)g(are)h(guaranteed)d(to)i(be)g
(transmitted)g(promptly)-5 b(.)0 988 y(The)19 b(o)o(v)o(erhead)d(of)j
(using)f(the)h(TBO)h(is)g(lar)o(gely)d(lost)j(in)f(the)g(noise)0
1088 y(when)h(v)o(ery)f(lar)o(ge)g(strings)h(are)g(transferred.)0
1325 y Fr(5)119 b(T)-9 b(rusting)30 b(the)h(TBO)0 1451
y Fl(Gi)n(v)o(en)24 b(that)h(a)g(serv)o(er)f(cannot)g(in)h(general)f
(trust)h(its)h(clients,)g(we)0 1550 y(need)j(to)i(account)d(for)i(why)f
(injecting)g(the)h(TBO)h(as)f(an)g(inter)n(-)0 1650 y(mediary)20
b(is)h(helpful,)f(and)g(what)h(constraints)g(must)f(be)h(satis\002ed)0
1750 y(if)32 b(the)h(TBO)g(is)g(to)f(be)g(safely)g(trusted.)61
b(The)32 b(constraints)f(are)0 1849 y(straightforw)o(ard:)83
1991 y Fi(\017)41 b Fl(The)47 b(returning)e(serv)o(er)h(must)h(be)g
(able)f(to)h(determine)166 2091 y(whether)25 b(it)i(is)g(returning)c
(to)k(a)f(TBO)g(\226)h(that)f(is,)i(to)e(a)g(pro-)166
2190 y(cess)32 b(e)o(x)o(ecuting)e(code)g(that)i(can)f(be)g(trusted)g
(to)h(respond)166 2290 y(promptly)-5 b(.)83 2444 y Fi(\017)41
b Fl(The)32 b(serv)o(er)g(must)g(be)h(in)f(a)h(position)f(to)g(kno)n(w)
g(that)g(the)166 2544 y(TBO)19 b(will)g(actually)e Fn(e)n(xecute)h
Fl(that)h(code)e(\226)h(that)h(is,)g(that)f(the)166 2643
y(client)25 b(cannot)e(disable)i(the)f(scheduling)f(authority)g(under)
166 2743 y(which)d(the)g(TBO)h(is)g(e)o(x)o(ecuting.)100
2885 y(Prior)44 b(to)h(the)f(w)o(ork)g(described)g(here,)50
b(ER)m(OS)45 b(pro)o(vided)0 2984 y(means)38 b(for)f(client)h
(authentication)e(and)h(reco)o(v)o(ery)f(from)g(de-)0
3084 y(struction,)55 b(b)n(ut)49 b(did)f(not)h(pro)o(vide)d(adequate)i
(control)f(o)o(v)o(er)0 3184 y(scheduling)18 b(authority)h(to)h
(support)f(the)h(TBO.)0 3378 y Fo(5.1)99 b(TBO)25 b(A)-5
b(uthentication)0 3515 y Fl(The)16 b(identi\002cation)g(of)g(a)h
(calling)f(application)f(\(as)i(distinct)g(from)0 3615
y(a)36 b(calling)g(principal\))f(is)i(directly)e(supported)f(by)i(the)g
(ER)m(OS)0 3715 y Fm(constructor)21 b Fl([32)o(])g(mechanism.)k(TBO)c
(objects)f(are)h(created)e(by)0 3814 y(the)26 b(TBO)h(constructor)-5
b(.)41 b(Ev)o(ery)25 b(ER)m(OS)h(constructor)e(\223brands\224)0
3914 y(each)15 b(process)g(that)g(it)h(creates)f(by)g(inserting)g(a)g
(unique)f(capability)0 4014 y(into)21 b(a)h(reserv)o(ed)e(capability)h
(\002eld)h(of)f(the)g(created)g(process)g(\(the)0 4113
y(brand)k(slot\).)44 b(The)26 b(brand)f(capability)g(can)i(be)f(an)o(y)
g(con)m(v)o(enient)0 4213 y(capability)32 b(type.)64
b(T)-7 b(o)33 b(ensure)g(that)g(its)i(brand)d(is)i(uni)n(v)o(ersally)0
4312 y(unique)29 b(and)g(pri)n(v)n(ate,)j(the)e(constructor)e(uses)j(a)
g(distinguished)0 4412 y(start)21 b(capability)f(to)h(itself)g(as)g
(the)g(brand)e(for)h(its)i(products.)j(This)0 4512 y(distinguished)d
(start)i(capability)f(is)i(guaranteed)c(to)j(be)g(accessi-)0
4611 y(ble)c(only)g(to)g(that)g(constructor)-5 b(.)100
4711 y(T)e(o)15 b(support)f(application)g(authentication,)g(the)i(ER)m
(OS)g(k)o(ernel)0 4811 y(implements)h(an)i(operation)d(kno)n(wn)h(as)i
(the)g Fm(Identify)f Fl(operation.)0 4910 y(Gi)n(v)o(en)26
b(a)i(process,)g(resume,)g(or)e(start)i(capability)e(to)h(a)h(process)0
5010 y Fg(P)37 b Fl(and)25 b(an)f(alle)o(ged)g(brand)g(capability)-5
b(,)24 b(the)h Fe(Identify)f Fl(com-)0 5109 y(pares)29
b(the)h(alle)o(ged)e(brand)g(capability)h(with)h(the)f(actual)g(brand)0
5209 y(pre)n(viously)c(recorded)f(in)j(the)f(process)g
Fg(P)12 b Fl(.)45 b(The)26 b(operation)e(re-)0 5309 y(turns)c
Fe(true)g Fl(\()p Fe(false)p Fl(\))f(according)f(to)i(whether)f(the)h
(tw)o(o)g(brand)0 5408 y(capabilities)g(are)g(\(are)g(not\))f(equal.)
2091 91 y(Using)26 b(this)g(k)o(ernel)f(primiti)n(v)o(e,)g(an)o(y)g
(constructor)f(is)j(able)e(to)1992 191 y(identify)e(its)i(products.)36
b(Gi)n(v)o(en)23 b(access)i(to)g(the)f(TBO)h(construc-)1992
291 y(tor)m(,)30 b(an)o(y)e(service)h(can)f(identify)g(whether)g(it)h
(is)h(returning)d(to)i(a)1992 390 y(TBO.)1992 587 y Fo(5.2)99
b(Assurance)25 b(of)g(Execution)1992 724 y Fl(There)19
b(are)i(four)e(w)o(ays)i(in)g(which)f(the)g(client)h(might)f(pre)n(v)o
(ent)f(the)1992 824 y(TBO)h(from)f(e)o(x)o(ecuting:)2054
974 y(1.)41 b(The)15 b(client)i(might)e(reclaim)h(its)h(storage)e(by)h
(destro)o(ying)f(the)2158 1073 y(space)j(bank)g(\(the)h(source)f(of)h
(storage\))f(from)g(which)g(it)i(w)o(as)2158 1173 y(created.)33
b(In)23 b(this)h(e)n(v)o(ent)e(the)i(capability)e(to)i(the)f(TBO)h
(will)2158 1272 y(become)30 b(detectably)h(in)m(v)n(alid,)i(so)f(the)g
(serv)o(er)f(is)i(able)e(to)2158 1372 y(detect)20 b(defection.)2054
1488 y(2.)41 b(The)50 b(client)h(might)f(reclaim)g(TBO)h(storage)f(in)h
(mid-)2158 1588 y(transaction,)21 b(while)h(the)g(serv)o(er)f(is)i(w)o
(aiting)f(for)f(the)h(TBO.)2158 1688 y(The)31 b(ER)m(OS)h(k)o(ernel)f
(already)g(mak)o(es)h(pro)o(vision)e(for)h(de-)2158 1787
y(fense)19 b(against)h(this:)26 b(destruction)18 b(of)i(a)h(process)e
(causes)i(its)2158 1887 y(outstanding)g(resume)i(capabilities)h(to)g
(be)f(in)m(v)n(ok)o(ed,)g(w)o(ak-)2158 1986 y(ing)c(the)i(serv)o(er)-5
b(.)2054 2103 y(3.)41 b(The)23 b(client)g(might)g(contri)n(v)o(e)f(to)i
(starv)o(e)f(the)h(TBO)g(of)f(stor)n(-)2158 2202 y(age)33
b(by)h(pro)o(viding)e(an)i(inadequately)d(populated)i(space)2158
2302 y(bank.)68 b(The)35 b(TBO)h(code)e(guards)g(against)h(this)g(and)g
(re-)2158 2402 y(turns)19 b(an)g(appropriate)e(error)i(if)g(this)h
(occurs,)f(allo)n(wing)g(the)2158 2501 y(serv)o(er)g(to)h(detect)g
(defection.)2054 2617 y(4.)41 b(The)17 b(client)g(can)g(disable)g(the)h
(TBO')-5 b(s)18 b(schedule)f(during)e(e)o(x-)2158 2717
y(ecution.)2091 2867 y(T)-7 b(o)40 b(address)e(the)i(last)g(problem,)i
(we)d(are)g(adding)f(a)i(ne)n(w)1992 2967 y(feature)29
b(into)h(the)g(ne)o(xt)g(generation)e(ER)m(OS)j(IPC)g(mechanism:)1992
3066 y Fm(sc)o(hedule)24 b(donation)p Fl(.)37 b(If)24
b(both)f(in)m(v)n(ok)o(er)g(and)h(in)m(v)n(ok)o(ee)f(agree)g(to)1992
3166 y(do)f(so,)i(the)g(in)m(v)n(ok)o(er')-5 b(s)22 b(schedule)g
(capability)g(will)i(be)f(copied)f(to)1992 3266 y(the)g(in)m(v)n(ok)o
(ee)f(as)i(a)g(side)g(ef)n(fect)f(of)h(the)f(in)m(v)n(ocation.)30
b(Agreement)1992 3365 y(is)25 b(required)d(so)i(that)g(a)h(service)f
(can)g(decline)f(to)h(e)o(x)o(ecute)f(under)1992 3465
y(caller)h(control.)38 b(Similarly)-5 b(,)25 b(it)h(should)e(not)g(be)h
(possible)f(for)h(an)1992 3565 y(arbitrary)f(program)h(to)i(acquire)e
(a)i(thread)e(of)i(control)e(from)h(its)1992 3664 y(caller)f(by)g
(trick)o(ery)-5 b(.)39 b(The)25 b(L4)g(IPC)h(design)f(pro)o(vides)f(a)h
(similar)1992 3764 y(mechanism.)2091 3863 y(The)k(speci\002cation)f(of)
h(schedule)f(donation)f(is)j(that)f(the)g(re-)1992 3963
y(cipient)f(continues)f(to)i(e)o(x)o(ecute)e(under)h(the)g(donated)g
(schedule)1992 4063 y(until)h(such)g(time)h(as)g(it)g(e)o(xplicitly)e
(alters)i(its)g(o)n(wn)f(scheduling)1992 4162 y(authority)-5
b(,)24 b(either)h(e)o(xplicitly)g(or)g(by)g(accepting)f(another)g
(dona-)1992 4262 y(tion.)34 b(This)24 b(implies)f(that)h(the)f
(donating)f(process)h(trusts)g(the)h(re-)1992 4362 y(cipient)19
b(to)h(gi)n(v)o(e)e(up)i(the)f(donated)f(schedule)h(when)g
(appropriate.)1992 4461 y(As)29 b(the)f(TBO)h(is)g(trusted,)g(schedule)
e(donation)g(is)i(appropriate)1992 4561 y(here.)g(Ha)n(ving)21
b(established)g(the)h(identity)f(and)g(safe)h(scheduling)1992
4660 y(control)g(of)h(the)g(TBO,)h(the)g(serv)o(er)e(returns)h(an)g(e)o
(xtended)f(string)1992 4760 y(to)16 b(the)g(TBO)h(using)f(a)g
Fm(non-prompt)f(return)j Fl(operation)c(\(one)h(that)1992
4860 y(permits)k(page)h(f)o(ault)g(servicing\).)2091
4959 y(Once)e(a)g(string)f(has)h(been)f(loaded)g(into)g(the)h(TBO)g(by)
f(a)h(serv)o(er)1992 5059 y(process,)h(the)h(only)g(operations)e(the)i
(client)h(can)f(do)f(are)2075 5209 y Fi(\017)41 b Fl(Fetch)30
b(the)g(string.)54 b(Doing)30 b(so)g(forces)g(the)g(client)g(to)g(do-)
2158 5309 y(nate)24 b(scheduling)e(authority)h(to)h(the)g(TBO)h
(object,)f(relie)n(v-)2158 5408 y(ing)c(the)h(serv)o(er)f(of)h(an)o(y)f
(remaining)f(scheduling)h(e)o(xposure)1929 5657 y(9)p
eop
%%Page: 10 10
10 9 bop 166 91 a Fl(that)19 b(might)f(arise)h(from)f(an)h(error)f(in)g
(the)h(TBO)h(implemen-)166 191 y(tation.)83 307 y Fi(\017)41
b Fl(Ignore)33 b(the)i(TBO.)h(In)e(this)i(case)f(the)g(TBO)h(will)f
(retain)166 407 y(the)22 b(serv)o(er)e(schedule)h(until)g(destro)o
(yed,)f(b)n(ut)i(as)g(it)g(will)g(not)166 506 y(initiate)30
b(instructions)f(without)h(an)g(in)m(v)n(ocation)e(from)h(the)166
606 y(client,)21 b(and)g(an)o(y)f(such)h(in)m(v)n(ocation)e(will)j
(force)e(a)i(schedule)166 706 y(donation,)33 b(we)g(do)e(not)h(really)g
(care)g(what)g(schedule)f(the)166 805 y(TBO)21 b(acts)g(under)-5
b(.)100 973 y(Note)53 b(that)g(neither)f(of)g(these)h(actions)g
(imposes)g(addi-)0 1073 y(tional)23 b(client-controlled)e(costs)j(on)g
(the)f(serv)o(er)n(-supplied)e(TBO)0 1172 y(scheduling)d(authority)-5
b(.)23 b(Scheduling)c(isolation)g(is)j(preserv)o(ed.)0
1418 y Fr(6)119 b(Related)31 b(W)-9 b(ork)0 1545 y Fl(While)26
b(man)o(y)f(of)h(the)g(pieces)g(described)f(here)g(rely)h(on)g(se)n(v)o
(eral)0 1645 y(generations)d(of)i(impro)o(v)o(ement)d(in)k(the)f(ER)m
(OS)g(system,)i(ER)m(OS)0 1745 y(o)n(wes)20 b(a)h(tremendous)d(debt)i
(to)g(its)h(predecessor)e(K)n(e)o(yK)n(OS)g([11)o(].)100
1845 y(A)f(great)g(deal)g(of)g(w)o(ork)f(on)h(thread-migrating)d(IPC)j
(has)h(been)0 1944 y(done)g(in)h(the)g(last)h(decade,)e(most)h(notably)
e(by)i(Liedtk)o(e)f([20)o(,)h(21)o(],)0 2044 y(F)o(ord)f([8],)h(and)g
(Shapiro)f([31)o(].)25 b(Though)18 b(the)j(K)n(e)o(yK)n(OS)e(capabil-)0
2144 y(ity)d(in)m(v)n(ocation)f(mechanism)f([11)o(])j(predates)e(it,)i
(most)f(of)g(the)g(cur)n(-)0 2243 y(rent)24 b(w)o(ork)f(on)h
(thread-migrating)c(IPC)25 b(deri)n(v)o(es)e(in)i(some)f(mea-)0
2343 y(sure)k(from)g(the)g(\223lightweight)f(remote)h(procedure)e
(call\224)j(w)o(ork)0 2443 y(by)20 b(Bershad)g([2)o(].)100
2543 y(W)-7 b(ork)21 b(on)g(pack)o(et)g(\002ltering)g([26)n(,)h(24)o(,)
g(6)o(])g(is)g(similar)g(in)f(\003a)n(v)n(or)0 2642 y(to)27
b(the)f(more)g(restricted)g(\002ltering)g(performed)d(by)j(\002ltering)
g(in-)0 2742 y(directors.)39 b(W)-7 b(e)27 b(are)e(not)g(a)o(w)o(are)g
(of)g(such)g(\002lters)h(being)e(used)h(to)0 2842 y Fn(defer)g
Fl(pack)o(et)d(processing,)g(nor)h(do)f(the)o(y)g(appear)g(to)h(ha)n(v)
o(e)g(been)0 2941 y(used)d(to)g(\002lter)h(dynamically)d(tagged)h
(messages.)100 3042 y(Use)26 b(of)g(re)o(gisters)g(to)g(speed)f
(interprocess)g(communication)0 3141 y(w)o(as)20 b(hea)n(vily)f(used)g
(in)g(the)h(V)g(Distrib)n(uted)f(System)g([4)o(],)h(and)e(ap-)0
3241 y(pears)e(to)g(ha)n(v)o(e)g(been)f(independently)e(proposed)h(by)i
(Kar)o(ger)e([16)o(])0 3340 y(in)20 b(connection)f(with)h(the)g(SCAP)i
(system)e([17)o(,)h(15)o(].)k(The)20 b(SCAP)0 3440 y(design)j(gains)h
(particular)f(adv)n(antage)f(if)i(the)g(trust)g(relationship)0
3540 y(between)19 b(caller)i(and)e(callee)i(is)g(kno)n(wn)d(to)j(both)e
(parties.)100 3640 y(Liedtk)o(e)24 b Fn(et)i(al.)39 b
Fl([22)o(])25 b(ha)n(v)o(e)g(considered)e(selected)i(denial)f(of)0
3740 y(service)19 b(attacks)h(against)f(the)g(L4)h(microk)o(ernel)d
(and)i(its)i(serv)o(ers,)0 3839 y(including)27 b(se)n(v)o(eral)h(of)g
(the)h(problems)e(identi\002ed)h(here.)50 b(Their)0 3939
y(w)o(ork)16 b(does)h(not)g(e)o(xamine)f(application-le)n(v)o(el)e
(vulnerabilities)i(in)0 4038 y(depth,)30 b(nor)e(does)h(it)h(propose)e
(design)g(re\002nements)g(to)h(the)g(L4)0 4138 y(IPC)21
b(architecture)e(that)h(might)f(mitigate)h(its)h(vulnerabilities.)100
4238 y(The)15 b(dynamic)g(return)g(payload)f(problem)h(addressed)g(in)h
(Sec-)0 4338 y(tion)k(4.3)f(is)i(identical)f(to)g(the)g(one)g(w)o(ay)g
(netw)o(ork)e(transfer)i(prob-)0 4438 y(lem)g(in)f(multile)n(v)o(el)g
(secure)g(systems,)h(noted)f(by)g(Kar)o(ger)f(and)h(in-)0
4537 y(dependently)25 b(by)h(Rushby)h([14)n(,)h(28)o(].)46
b(In)27 b(a)g(one)g(w)o(ay)g(netw)o(ork)0 4637 y(transfer)m(,)17
b(the)i(recipient)e(is)j(incapable)d(of)h(signaling)f(error)g(to)i(the)
0 4736 y(sender)e(and)g(therefore)f(must)i(pro)o(vide)d(suf)n
(\002cient)i(storage)g(to)h(ac-)0 4836 y(cept)i(a)h(message)f(of)g
(unkno)n(wn)d(length.)0 5082 y Fr(7)119 b(Ackno)o(wledgements)0
5209 y Fl(The)26 b(impetus)g(for)f(the)h(w)o(ork)g(described)f(here)g
(w)o(as)j(the)e(imple-)0 5309 y(mentation)i(of)i(the)f(CapIDL)h
(capability)e(IDL)i(system,)i(which)0 5408 y(is)41 b(deri)n(v)o(ed)d
(closely)h(from)g(earlier)g(IDL)h(w)o(ork)f(in)h(CORB)m(A.)1992
91 y(CapIDL)21 b(w)o(as)h(jointly)f(designed)f(by)h(Mark)g(Miller)h
(and)e(the)i(au-)1992 191 y(thor)-5 b(.)24 b(A)18 b(recent)g
(discussion)g(with)g(Da)n(v)o(e)g(Presotto)g(helped)f(spark)1992
291 y(the)i(last)h(connections)d(that)i(led)h(to)f(the)g(in)m(v)o
(ention)e(of)i(the)g(trusted)1992 390 y(b)n(uf)n(fer)f(object.)2091
496 y(ER)m(OS)j(b)n(uilds)f(hea)n(vily)g(on)g(the)h(K)n(e)o(yK)n(OS)e
(system)i(designed)1992 595 y(by)28 b(Norm)h(Hardy)-5
b(,)29 b(Charles)h(Landau,)g(Alan)f(Bomber)o(ger)m(,)f(and)1992
695 y(Bill)h(Frantz)g(while)f(at)i(T)-7 b(ymshare,)29
b(Inc.)50 b(All)29 b(of)g(these)g(people)1992 795 y(ha)n(v)o(e)23
b(been)g(helpful)g(and)h(patient)f(in)h(describing)f(the)h(w)o(orkings)
1992 894 y(of)30 b(K)n(e)o(yK)n(OS)g(and)g(encouraging)e(the)j(de)n(v)o
(elopment)d(and)i(e)n(v)n(o-)1992 994 y(lution)g(of)h(the)f(ER)m(OS)i
(system.)57 b(Bryan)31 b(F)o(ord)f(has)h(been)f(kind)1992
1093 y(enough)d(at)k(v)n(arious)e(points)g(to)h(e)o(xplain)f(a)h
(number)f(of)g(details)1992 1193 y(in)22 b(the)h(Fluk)o(e)f
(implementation)f(and)h(the)h(Mach)f(v)o(ersion)f(4)i(IPC)1992
1293 y(implementation.)2091 1398 y(Jochen)j(Liedtk)o(e)g(took)g(the)g
(time)h(se)n(v)o(eral)f(years)g(ago)h(while)1992 1498
y(we)k(were)g(both)f(at)i(IBM)g(to)f(discuss)h(the)f(merits)g(of)g
(timeouts)1992 1597 y(and)d(the)i(problem)d(of)i(hostile)g(pagers.)52
b(Jochen')-5 b(s)29 b(continuous)1992 1697 y(adv)n(ances)f(in)j(the)f
(performance)d(and)i(design)h(of)g(microk)o(ernel)1992
1797 y(operating)22 b(systems)k(led)f(to)g(impro)o(v)o(ements)d(in)j
(the)f(ER)m(OS)i(im-)1992 1896 y(plementation)f(and)i(dro)o(v)o(e)e(us)
j(to)f(a)h(deeper)e(and)h(more)g(careful)1992 1996 y(understanding)17
b(of)j(operating)f(system)h(design.)26 b(Y)-9 b(oon-Ho)18
b(P)o(ark)1992 2096 y(similarly)27 b(took)h(time)g(to)h(discuss)f(the)g
(e)o(xperiences)f(of)h(the)g(L4)1992 2195 y(team)20 b(in)g(b)n(uilding)
f(the)h(Sa)o(wMill)h(system)f([10)o(].)2091 2301 y(This)i(paper)f
(originated)g(from)g(a)h(discussion)g(with)g(Jay)g(Lep-)1992
2400 y(reau)g(at)j(the)e(Symposium)f(on)h(Operating)f(System)i(Design)f
(and)1992 2500 y(Implementation)12 b(in)k(1999,)f(which)g(\002rst)i
(prompted)c(us)j(to)g(recog-)1992 2600 y(nize)i(that)i(vulnerabilities)
d(in)j(synchronous)c(IPC)k(systems)f(arise)1992 2699
y(from)24 b(the)i(comple)o(x)e(and)h(subtle)h(interaction)e(of)h(man)o
(y)g(f)o(actors)1992 2799 y(in)g(their)h(designs,)g(and)f(that)h(these)
f(interactions)g(had)g(not)g(been)1992 2898 y(adequately)18
b(e)o(xplored)g(in)i(the)g(archi)n(v)n(al)f(literature.)1992
3173 y Fr(8)119 b(Conclusions)1992 3310 y Fl(In)24 b(addition)g(to)h(f)
o(ast)g(performance,)e(an)h(ef)n(fecti)n(v)o(e)g(interprocess)1992
3410 y(communication)17 b(system)j(must)g(pro)o(vide)e(reproducible)g
(beha)n(v-)1992 3510 y(ior)m(,)f(deal)h(with)g(assymetric)f(trust)h
(among)f(communicating)e(pro-)1992 3609 y(cesses,)26
b(and)f(enable)f(support)f(for)i(messages)g(that)f(contain)g(dy-)1992
3709 y(namically)j(sized)i(payloads.)50 b(This)29 b(paper)f(describes)g
(why)g(si-)1992 3808 y(multaneous)16 b(satisf)o(action)i(of)f(these)h
(requirements)e(is)j(challeng-)1992 3908 y(ing,)33 b(and)d
(identi\002es)h(a)h(set)g(of)f(enhancements)e(to)i(the)g(current)1992
4008 y(ER)m(OS)22 b(system)h(that)f(let)h(us)g(meet)f(all)h(three)f
(design)g(objecti)n(v)o(es.)1992 4107 y(T)-7 b(w)o(o)30
b(k)o(e)o(y)g(enablers)g(of)h(the)f(solution)g(proposed)f(here)h(are)h
(the)1992 4207 y(ability)26 b(in)h(ER)m(OS)g(to)g(authenticate)e(the)i
(code)f(e)o(x)o(ecuted)e(by)j(an)1992 4307 y(application)k(independent)
e(of)k(its)g(user)m(,)i(and)d(the)h(ability)f(\(via)1992
4406 y(con\002nement\))16 b(to)i(protect)g(a)h(trusted)f(program)e
(from)h(tampering)1992 4506 y(by)22 b(its)i(user)-5 b(.)34
b(No)23 b(generally)f(satisf)o(actory)h(means)f(to)i(satisfy)f(all)1992
4605 y(of)18 b(these)h(requirements)e(simultaneously)g(has)i(pre)n
(viously)e(been)1992 4705 y(proposed.)2091 4811 y(T)-7
b(o)23 b(our)e(kno)n(wledge,)f(no)i(pre)n(vious)f(papers)h(ha)n(v)o(e)f
(been)h(pub-)1992 4910 y(lished)15 b(that)i(e)o(xpose)e(in)h(depth)f
(or)h(adequately)e(address)i(the)g(inter)n(-)1992 5010
y(process)26 b(denial)h(of)f(service)h(vulnerabilities)f(that)h(are)g
(implicit)1992 5109 y(in)22 b(synchronous)d(IPC)k(designs.)30
b(The)22 b(analysis)g(presented)f(here)1992 5209 y(illustrates)f(in)g
(detail)h(an)f(unusual)f(case)i(of)e(authority)g(f)o(actoring:)1992
5309 y(the)26 b(pro)o(vider)e(of)i(the)h(trusted)f(b)n(uf)n(fer')-5
b(s)25 b(storage)h(authority)f(and)1992 5408 y(the)e(pro)o(vider)e(of)i
(its)h(e)o(x)o(ecution)d(authority)h(need)h(to)g(be)h(distinct)1908
5657 y(10)p eop
%%Page: 11 11
11 10 bop 0 91 a Fl(in)23 b(order)f(to)i(pre)n(v)o(ent)d(certain)i
(classes)h(of)f(denial)g(of)g(service)g(at-)0 191 y(tacks.)62
b(Based)33 b(on)f(other)g(ongoing)f(design)g(acti)n(vities)i(within)0
291 y(the)22 b(ER)m(OS)g(community)-5 b(,)19 b(this)k(appears)d(to)i
(be)g(an)g(e)o(xample)e(of)i(a)0 390 y(general)e(pattern)g(that)h(emer)
o(ges)f(in)h(man)o(y)f(places)h(where)g(multi-)0 490
y(ple)o(xing)e(crosses)h(a)h(trust)f(boundary)-5 b(.)100
595 y(The)50 b(solution)h(proposed)e(here)h(le)n(v)o(erages)g
(application-)0 694 y(based)32 b(authentication)e(hea)n(vily)-5
b(.)60 b(W)-7 b(e)34 b(rely)e(on)g(the)g(ability)g(to)0
794 y(identify)24 b(and)h(safely)g(e)o(x)o(ecute)f(components)g(that)h
(are)g(instanti-)0 893 y(ated)20 b(by)g(untrusted)f(pro)o(viders,)f
(and)i(whose)f(storage)h(originates)0 993 y(from)i(an)g(untrusted)g
(source)g(\(the)g(client\).)33 b(It)23 b(is)g(dif)n(\002cult)g(to)f
(see)0 1093 y(ho)n(w)27 b(this)i(particular)e(w)o(ay)h(of)f(straddling)
g(the)h(trust)g(boundary)0 1192 y(can)d(be)g(achie)n(v)o(ed)e(without)i
(some)g(form)f(of)h(protected)e(naming)0 1292 y(primiti)n(v)o(e.)41
b(In)26 b(our)f(TBO)i(approach,)e(the)h(serv)o(er)f(relies)i(on)e(re-)0
1392 y(cei)n(ving)19 b(such)g(a)i(name)e(\(the)h(resume)f(capability\))
f(as)j(a)f(basis)h(for)0 1491 y(authenticating)i(the)h(TBO.)h(W)m(ith)g
(care,)h(a)f(cryptographic)c(hash)0 1591 y(of)16 b(the)g(in)m(v)n(ok)o
(er)f(e)o(x)o(ecutable)f(image)i(injected)g(by)g(the)g(k)o(ernel)f
(into)0 1691 y(e)n(v)o(ery)26 b(in)m(v)n(ocation)g(might)h(serv)o(e)g
(as)h(a)h(substitute)e(for)g(capabil-)0 1790 y(ities.)58
b(Note)30 b(that)h(this)g(hash)g(can)f(be)h(cached)f(in)h(the)f(k)o
(ernel')-5 b(s)0 1890 y(per)n(-process)19 b(data)h(structure;)f(its)i
(use)g(need)e(not)h(be)g(e)o(xpensi)n(v)o(e.)100 1995
y(Gi)n(v)o(en)k(the)h(number)e(of)i(IPC)h(systems)g(\(and)e(more)g
(broadly)-5 b(,)0 2094 y(operating)28 b(systems\))i(that)f(do)g(not)h
(adequately)e(support)g(com-)0 2194 y(munication)35 b(across)i
(assymetric)f(trust)h(relationships,)i(it)e(ap-)0 2293
y(pears)24 b(that)h(the)g(issues)g(in)m(v)n(olv)o(ed)e(are)h(not)h
(widely)f(understood.)0 2393 y(One)31 b(goal)f(of)h(this)g(paper)f(is)h
(to)g(ensure)f(that)h(the)g(problem)e(of)0 2493 y(asymmetric)f(trust)g
(is)i(not)e(ne)o(glected)f(in)i(future)e(IPC)j(designs,)0
2592 y(and)20 b(to)g(describe)f(one)h(strate)o(gy)f(for)h(ho)n(w)g(to)g
(support)f(it.)0 2863 y Fr(Refer)n(ences)51 2991 y Fc([1])42
b(M.)24 b(Acceta,)i(R.)d(V)-10 b(.)25 b(Baron,)g(W)-7
b(.)24 b(Bolosk)o(y)-5 b(,)26 b(D.)e(B.)g(Golub,)i(R.)d(F)-6
b(.)180 3082 y(Rashid,)34 b(A.)d(T)-5 b(e)n(v)n(anian)32
b(Jr)l(.,)i(and)e(M.)f(W)-7 b(.)31 b(Y)-8 b(oung.)67
b(Mach:)50 b(A)180 3173 y(ne)n(w)26 b(k)o(ernel)g(foundation)g(for)g
(UNIX)e(de)n(v)o(elopment.)50 b(In)25 b Fb(Pr)m(oc.)180
3265 y(1986)h(USENIX)d(Summer)j(T)-7 b(ec)o(hnical)25
b(Confer)m(ence)p Fc(,)i(pages)e(93\226)180 3356 y(112,)19
b(June)h(1986.)51 3454 y([2])42 b(B.)35 b(Bershad,)41
b(T)-6 b(.)35 b(Anderson,)41 b(E.)35 b(Lazo)n(wska,)41
b(and)c(H.)e(Le)n(vy)-5 b(.)180 3545 y(Lightweight)28
b(remote)h(procedure)h(call.)56 b(In)29 b Fb(Pr)m(oc.)e(12th)i(Sym-)180
3636 y(posium)21 b(on)f(Oper)o(ating)h(Systems)f(Principles)p
Fc(,)g(pages)h(102\226113,)180 3728 y(Dec.)d(1989.)51
3825 y([3])42 b(J.)25 b(B.)g(Chen)h(and)h(B.)e(N.)g(Bershad.)49
b(The)26 b(impact)g(of)f(operating)180 3916 y(system)15
b(structure)h(on)g(memory)g(system)f(performance.)21
b(In)15 b Fb(Pr)m(oc.)180 4008 y(14th)29 b(Symposium)h(on)f(Oper)o
(ating)h(Systems)f(Principles)p Fc(,)i(Dec.)180 4099
y(1993.)51 4196 y([4])42 b(D.)18 b(Cheriton.)27 b(The)19
b(v)g(distrib)o(uted)g(system.)27 b(\(3\),)19 b(Mar)l(.)f(1988.)51
4294 y([5])42 b Fb(U)n(.S.)36 b(Department)g(of)g(Defense)h(T)l(rusted)
f(Computer)h(System)180 4385 y(Evaluation)19 b(Criteria)p
Fc(,)g(1985.)51 4483 y([6])42 b(D.)14 b(Engler)h(and)g(M.)g(F)-6
b(.)13 b(Kaashoek.)19 b(Dpf:)i(F)o(ast,)15 b(\003e)o(xible)f(message)
180 4574 y(demultiple)o(xing)25 b(using)f(dynamic)h(code)g(generation.)
43 b(In)24 b Fb(Pr)m(oc.)180 4665 y(SIGCOMM)h('96)g(Confer)m(ence)p
Fc(,)i(pages)e(53\22659,)i(Stanford,)f(CA,)180 4757 y(USA,)18
b(Aug.)h(1992.)51 4854 y([7])42 b(B.)22 b(F)o(ord,)i(M.)g(Hibler)m(,)f
(J.)g(Lepreau,)i(R.)e(McGrath,)h(and)g(P)-8 b(.)22 b(T)m(ull-)180
4946 y(mann.)30 b(Interf)o(ace)20 b(and)g(e)o(x)o(ecution)g(models)h
(in)e(the)h(\003uk)o(e)g(k)o(ernel.)180 5037 y(In)f Fb(Pr)m(oc.)g(3r)m
(d)h(Symposium)g(on)g(Oper)o(ating)g(System)g(Design)f(and)180
5128 y(Implementation)p Fc(,)g(pages)h(101\226115,)h(Feb)m(.)d(1999.)51
5226 y([8])42 b(B.)23 b(F)o(ord)g(and)i(J.)e(Lepreau.)43
b(Ev)o(olving)24 b(Mach)g(3.0)g(to)g(a)g(migrat-)180
5317 y(ing)f(threads)g(model.)39 b(In)22 b Fb(Pr)m(oc.)g(W)l(inter)h
(USENIX)e(Confer)m(ence)p Fc(,)180 5408 y(pages)f(97\226114,)g(Jan.)f
(1994.)2043 91 y([9])41 b(E.)14 b(Gabber)m(,)i(C.)e(Small,)h(J.)f
(Bruno,)i(J.)f(Brustoloni,)g(and)h(A.)e(Silber)o(-)2171
183 y(schatz.)23 b(The)17 b(pebble)g(component-based)j(operating)d
(system.)23 b(In)2171 274 y Fb(Pr)m(oc.)e(1999)i(USENIX)d(Annual)j(T)-7
b(ec)o(hnical)22 b(Confer)m(ence)p Fc(,)h(pages)2171
365 y(267\226282,)e(Montere)o(y)-5 b(,)20 b(CA,)e(USA,)g(June)i(1999.)
2005 452 y([10])42 b(A.)19 b(Gef)n(\003aut,)g(T)-6 b(.)18
b(Jae)o(ger)m(,)i(Y)-10 b(.)18 b(P)o(ark,)h(J.)g(Liedtk)o(e,)g(K.)f
(Elphinstone,)2171 543 y(V)-10 b(.)33 b(Uhlig,)j(J.)d(T)m(idswell,)j
(L.)c(Deller)m(,)k(and)d(L.)g(Reuther)l(.)72 b(The)2171
635 y(Sa)o(wMill)29 b(multiserv)o(er)h(approach.)63 b(In)30
b Fb(Pr)m(oc.)f(A)n(CM)g(SIGOPS)2171 726 y(Eur)m(opean)20
b(W)-7 b(orkshop)p Fc(,)21 b(Sept.)d(2000.)2005 813 y([11])42
b(N.)21 b(Hardy)-5 b(.)36 b(The)22 b(K)n(e)o(yK)n(OS)f(architecture.)36
b Fb(Oper)o(ating)22 b(Systems)2171 904 y(Re)o(vie)o(w)p
Fc(,)c(19\(4\):8\22625,)j(Oct.)d(1985.)2005 991 y([12])42
b(T)-6 b(.)21 b(Jae)o(ger)m(,)h(K.)e(Elphinstone,)i(J.)f(Liedtk)o(e,)h
(V)-10 b(.)21 b(P)o(anteleenk)o(o,)h(and)2171 1083 y(Y)-10
b(.)20 b(P)o(ark.)31 b(Fle)o(xible)20 b(access)h(control)f(using)h(IPC)
e(redirection.)32 b(In)2171 1174 y Fb(Pr)m(oc.)22 b(7th)h(W)-7
b(orkshop)24 b(on)f(Hot)f(T)-7 b(opics)23 b(in)f(Oper)o(ating)i
(Systems)p Fc(,)2171 1265 y(pages)c(191\226196.)h(IEEE,)c(Mar)l(.)i
(1999.)2005 1352 y([13])42 b(T)-6 b(.)16 b(Jae)o(ger)m(,)h(J.)f(E.)f(T)
m(idswell,)h(A.)g(Gef)n(\003aut,)g(Y)-10 b(.)16 b(P)o(ark,)g(K.)g(J.)g
(Elphin-)2171 1443 y(stone,)25 b(and)f(J.)f(Liedtk)o(e.)42
b(Synchronous)25 b(IPC)d(o)o(v)o(er)i(transparent)2171
1535 y(monitors.)41 b(In)23 b Fb(Pr)m(oc.)g(Ninth)g(A)n(CM/SIGOPS)f
(Eur)m(opean)i(W)-7 b(ork-)2171 1626 y(shop)22 b(\223Be)n(yond)e(the)g
(PC:)g(Ne)o(w)g(Challeng)o(es)h(for)g(the)f(Oper)o(ating)2171
1717 y(System\224)p Fc(,)f(Sept.)f(2000.)2005 1804 y([14])42
b(P)-8 b(.)23 b(Kar)o(ger)l(.)41 b Fb(Non-Discr)m(etionary)25
b(Access)f(Contr)m(ol)g(for)f(Decen-)2171 1896 y(tr)o(alized)k
(Computing)h(Systems)p Fc(.)52 b(PhD)27 b(thesis,)h(Massachusetts)2171
1987 y(Institute)f(of)g(T)-5 b(echnology)g(,)30 b(Cambridge)d
(Massachusetts,)j(May)2171 2078 y(1977.)e(MIT/LCS/TR-179.)2005
2165 y([15])42 b(P)-8 b(.)17 b(Kar)o(ger)l(.)26 b Fb(Impr)m(o)o(ving)19
b(Security)g(and)g(P)-6 b(erformance)19 b(for)f(Capa-)2171
2256 y(bility)h(Systems)p Fc(.)30 b(PhD)19 b(thesis,)h(Uni)n(v)o
(ersity)f(of)h(Cambridge,)g(Oct.)2171 2348 y(1988.)28
b(T)-5 b(echnical)19 b(Report)g(No.)g(149.)2005 2435
y([16])42 b(P)-8 b(.)28 b(A.)g(Kar)o(ger)l(.)59 b(Using)29
b(re)o(gisters)f(to)h(optimize)g(cross-domain)2171 2526
y(call)17 b(performance.)25 b Fb(A)n(CM)17 b(SIGARCH)f(Computer)i(Ar)m
(c)o(hitectur)m(e)2171 2617 y(Ne)o(ws)p Fc(,)g(\(2\):194\226204,)j(Apr)
l(.)e(1989.)2005 2704 y([17])42 b(P)-8 b(.)21 b(A.)g(Kar)o(ger)h(and)g
(A.)f(J.)h(Herbert.)36 b(An)22 b(augmented)h(capability)2171
2795 y(architecture)i(to)f(support)h(lattice)f(security)h(and)g
(traceability)f(of)2171 2887 y(access.)k(In)18 b Fb(Pr)m(oc.)h(of)f
(the)h(1984)h(IEEE)e(Symposium)i(on)f(Security)2171 2978
y(and)h(Privacy)p Fc(,)f(pages)h(2\22612,)f(Oakland,)h(CA,)e(Apr)l(.)h
(1984.)g(IEEE.)2005 3065 y([18])42 b(P)-8 b(.)27 b(A.)g(Kar)o(ger)m(,)i
(M.)f(E.)f(Zurk)o(o,)j(D.)d(W)-7 b(.)27 b(Bonin,)j(A.)d(H.)g(Mason,)
2171 3156 y(and)21 b(C.)e(E.)g(Kahn.)31 b(A)20 b(retrospecti)n(v)o(e)h
(on)f(the)g(V)-10 b(AX)20 b(VMM)g(secu-)2171 3248 y(rity)i(k)o(ernel.)
38 b Fb(IEEE)21 b(T)l(r)o(ansactions)i(on)g(Softwar)m(e)g(Engineering)p
Fc(,)2171 3339 y(\(11\):1147\2261165,)f(No)o(v)-5 b(.)19
b(1991.)2005 3426 y([19])42 b(B.)34 b(W)-7 b(.)33 b(Lampson)h(and)h(H.)
e(E.)g(Stur)o(gis.)74 b(Re\003ections)34 b(on)g(an)2171
3517 y(operating)29 b(system)g(design.)57 b Fb(Communications)29
b(of)f(the)g(A)n(CM)p Fc(,)2171 3608 y(19\(4\):251\226265,)22
b(May)d(1976.)2005 3695 y([20])42 b(J.)18 b(Liedtk)o(e.)25
b(Impro)o(ving)19 b(IPC)e(by)h(k)o(ernel)h(design.)26
b(In)18 b Fb(Pr)m(oc.)f(14th)2171 3787 y(A)n(CM)24 b(Symposium)i(on)f
(Oper)o(ating)h(System)f(Principles)p Fc(,)h(pages)2171
3878 y(175\226188.)21 b(A)m(CM,)e(1993.)2005 3965 y([21])42
b(J.)32 b(Liedtk)o(e.)70 b(Impro)o(v)o(ed)33 b(address-space)h
(switching)e(on)h(Pen-)2171 4056 y(tium)i(processors)i(by)f
(transparently)g(multiple)o(xing)g(user)g(ad-)2171 4148
y(dress)17 b(spaces.)22 b(T)-5 b(echnical)16 b(Report)g(GMD)h(TR)e
(933,)j(GMD,)e(No)o(v)-5 b(.)2171 4239 y(1995.)2005 4326
y([22])42 b(J.)22 b(Liedtk)o(e,)h(N.)e(Islam,)h(and)h(T)-6
b(.)22 b(Jae)o(ger)l(.)37 b(Pre)n(v)o(enting)22 b(denial-of-)2171
4417 y(service)16 b(attacks)f(on)g(a)g Fa(\026)p Fc(-k)o(ernel)g(for)g
(weboses.)k(In)c Fb(Pr)m(oc.)f(HotOS-)2171 4508 y(VI)p
Fc(,)k(May)i(1997.)2005 4595 y([23])42 b(J.)21 b(L)6
b(\250)-31 b(oser)21 b(and)g(M.)g(Hohmuth.)34 b(Ome)o(ga0:)28
b(A)21 b(portable)g(interf)o(ace)2171 4687 y(to)g(interrupt)f(hardw)o
(are)h(for)f(l4)g(systems.)32 b(In)20 b Fb(Pr)m(oc.)g(F)m(ir)o(st)f(W)
-7 b(ork-)2171 4778 y(shop)37 b(on)f(Common)h(Micr)m(ok)o(ernel)g
(System)f(Platforms)p Fc(,)j(Dec.)2171 4869 y(1999.)28
b(Re)n(vised:)c(Je)n(wel)19 b(Edition,)g(January)h(5,)e(2000.)2005
4956 y([24])42 b(S.)27 b(McCanne)h(and)g(V)-10 b(.)28
b(Jacobson.)55 b(The)28 b(bsd)g(pack)o(et)g(\002lter:)39
b(A)2171 5047 y(ne)n(w)28 b(architecture)h(for)e(user)o(-le)n(v)o(el)h
(pack)o(et)h(capture.)56 b(In)27 b Fb(Pr)m(oc.)2171 5139
y(USENIX)14 b(T)-7 b(ec)o(hnical)15 b(Confer)m(ence)p
Fc(,)h(pages)g(259\226269,)h(Jan.)e(1993.)2005 5226 y([25])42
b(M.)24 b(S.)e(Miller)m(,)i(C.)e(Morningstar)m(,)k(and)e(B.)e(Frantz.)
41 b(Capability-)2171 5317 y(based)24 b(\002nancial)g(instruments.)40
b(In)23 b Fb(Pr)m(oc.)g(F)m(inancial)g(Crypto)o(g-)2171
5408 y(r)o(aphy)d(2000)p Fc(,)g(Anguila,)f(BWI,)f(2000.)i(Springer)o
(-V)-8 b(erlag.)1908 5657 y Fl(11)p eop
%%Page: 12 12
12 11 bop 14 91 a Fc([26])42 b(J.)15 b(Mogul,)i(R.)e(Rashid,)h(and)g
(M.)f(Accetta.)20 b(The)15 b(pack)o(et)i(\002lter:)j(An)180
183 y(ef)n(\002cient)f(mechanism)h(for)f(user)o(-le)n(v)o(el)g(netw)o
(ork)h(code.)29 b(In)19 b Fb(Pr)m(oc.)180 274 y(Ele)o(venth)24
b(A)n(CM)f(Symposium)j(on)e(Oper)o(ating)h(Systems)g(Princi-)180
365 y(ples)p Fc(,)19 b(pages)g(39\22651,)i(Austin,)d(TX,)g(USA,)g(No)o
(v)-5 b(.)19 b(1987.)14 452 y([27])42 b(M.)20 b(Rozier)m(,)g(V)-10
b(.)20 b(Abrossimo)o(v)-5 b(,)21 b(F)-6 b(.)19 b(Armand,)i(I.)e(Boule,)
i(M.)f(Gien,)180 544 y(M.)42 b(Guillemont,)49 b(F)-6
b(.)41 b(Hermann,)49 b(C.)42 b(Kaiser)m(,)48 b(S.)41
b(Langlois,)180 635 y(P)-8 b(.)24 b(Leonard,)j(and)f(W)-7
b(.)24 b(Neuhauser)l(.)48 b(Ov)o(ervie)n(w)26 b(of)f(the)h(Chorus)180
726 y(distrib)o(uted)20 b(system.)32 b(T)-5 b(echnical)20
b(Report)h(CS-TR-90-25,)f(Cho-)180 818 y(rus)33 b(Systemes,)j(F-78182)f
(St.)d(Quentin-en-Yv)o(elines)i(Cede)o(x,)180 909 y(France,)18
b(1991.)14 996 y([28])42 b(J.)26 b(Rushby)i(and)f(B.)f(Randell.)51
b(A)27 b(distrib)o(uted)f(secure)h(system.)180 1088 y
Fb(IEEE)17 b(Computer)p Fc(,)j(16\(7\):55\22667,)g(1983.)14
1175 y([29])42 b(M.)31 b(D.)g(Schroeder)m(,)k(D.)c(D.)g(Clark,)k(and)d
(J.)f(H.)g(Saltzer)l(.)66 b(The)180 1266 y(MUL)-7 b(TICS)19
b(k)o(ernel)j(design)g(project.)33 b(In)21 b Fb(Pr)m(oc.)f(6th)h(A)n
(CM)f(Sym-)180 1357 y(posium)32 b(on)h(Oper)o(ating)g(Systems)f
(Principles)p Fc(,)j(pages)e(43\22656.)180 1449 y(A)m(CM,)18
b(No)o(v)-5 b(.)19 b(1977.)14 1536 y([30])42 b(J.)17
b(S.)g(Shapiro,)g(D.)h(J.)f(F)o(arber)m(,)g(and)h(J.)g(M.)f(Smith.)24
b(The)17 b(measured)180 1627 y(performance)h(of)f(a)g(f)o(ast)g(local)f
(IPC.)22 b(In)17 b Fb(Pr)m(oc.)f(5th)h(International)180
1719 y(W)-7 b(orkshop)34 b(on)e(Object)g(Orientation)h(in)e(Oper)o
(ating)i(Systems)p Fc(,)180 1810 y(pages)20 b(89\22694,)g(Seattle,)e(W)
-9 b(A,)17 b(USA,)h(No)o(v)-5 b(.)19 b(1996.)h(IEEE.)14
1897 y([31])42 b(J.)27 b(S.)f(Shapiro,)j(J.)e(M.)g(Smith,)h(and)g(D.)e
(J.)h(F)o(arber)l(.)53 b(ER)m(OS)o(:)40 b(A)180 1988
y(f)o(ast)20 b(capability)h(system.)33 b(In)20 b Fb(Pr)m(oc.)g(17th)h
(A)n(CM)f(Symposium)i(on)180 2080 y(Oper)o(ating)17 b(Systems)h
(Principles)p Fc(,)f(pages)g(170\226185,)j(Kia)o(w)o(ah)d(Is-)180
2171 y(land)h(Resort,)g(near)h(Charleston,)f(SC,)f(USA,)h(Dec.)g(1999.)
h(A)m(CM.)14 2258 y([32])42 b(J.)21 b(S.)f(Shapiro)i(and)g(S.)f(W)-6
b(eber)l(.)35 b(V)-8 b(erifying)22 b(the)f(ER)m(OS)g(con\002ne-)180
2350 y(ment)g(mechanism.)33 b(In)21 b Fb(Pr)m(oc.)f(2000)i(IEEE)d
(Symposium)j(on)f(Se-)180 2441 y(curity)k(and)h(Privacy)p
Fc(,)g(pages)g(166\226176,)j(Oakland,)e(CA,)d(USA,)180
2532 y(2000.)14 2619 y([33])42 b(W)-7 b(.)13 b(A.)h(W)l(ulf,)h(R.)f(Le)
n(vin,)h(and)g(S.)e(P)-8 b(.)13 b(Harbison.)18 b Fb(HYDRA/C.mmp:)180
2711 y(An)h(Experimental)g(Computer)g(System)p Fc(.)27
b(McGra)o(w)20 b(Hill,)d(1981.)1908 5657 y Fl(12)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
